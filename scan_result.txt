
=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Flx.ahk ===

ï»¿#SingleInstance force
#Persistent
#NoEnv
#UseHook On          ; Ù„ØªØ­Ø³ÙŠÙ† Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ù…Ø¹Ù‚Ø¯Ø©
#InstallKeybdHook    ; Ù„Ø¶Ù…Ø§Ù† ØªØªØ¨Ø¹ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ø¨Ø´ÙƒÙ„ Ø¬ÙŠØ¯
;------------------ Global Settings ------------------
iniFile := A_ScriptDir "\Flx_Settings.ini"
scriptsDir := A_ScriptDir "\Scripts"
if !FileExist(scriptsDir) {
    FileCreateDir, %scriptsDir%
}
HotkeyConditions := {} ; Ù„ØªØªØ¨Ø¹ Ø´Ø±ÙˆØ· NoFlxHotkeys

IniRead, monitoredFolders, %iniFile%, Settings, MonitoredFolders, F:\Anime,F:\Movies
IniRead, monitoredFoldersWithSub, %iniFile%, Settings, MonitoredFoldersWithSub, F:\Anime
IniRead, excludedFolders, %iniFile%, Settings, ExcludedFolders, %A_Space%
IniRead, processNames, %iniFile%, Settings, ProcessNames, telegram.exe
IniRead, checkInterval, %iniFile%, Settings, CheckInterval, 1000
IniRead, isSecureMode, %iniFile%, Settings, IsSecureMode, 0
IniRead, baseHotkey, %iniFile%, HotkeySettings, BaseKey, SC056
global baseHotkey

InitSecureModeIndicator()

; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµÙ„Ø§Ø­ÙŠØ© baseHotkey
if (!baseHotkey || baseHotkey = "ERROR") {
    InputBox, baseHotkey, Ø¥Ø¯Ø®Ø§Ù„ Ø²Ø± Flx, Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ù…ÙØªØ§Ø­ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Ù…Ø«Ù„ SC056 Ø£Ùˆ SC029):,, 300, 150,,,, SC056
    if (ErrorLevel || baseHotkey = "") {
        MsgBox, 48, Ø®Ø·Ø£, Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø²Ø± Flx ØµØ§Ù„Ø­. Ø³ÙŠØªÙ… Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø³ÙƒØ±Ø¨Øª.
        ExitApp
    }
    IniWrite, %baseHotkey%, %iniFile%, HotkeySettings, BaseKey
}

; Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ baseHotkey
ReloadHotkeys("")  ; Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ ReloadHotkeys Ø¨Ø¯ÙˆÙ† oldBaseHotkey Ù„Ø£Ù†Ù‡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ÙˆÙ„ÙŠ

; ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© (Ù„Ù„ØªØ£ÙƒØ¯ ÙÙ‚Ø·)
try {
    Hotkey, %baseHotkey%, OpenInteractiveMode, On
    Hotkey, % baseHotkey " & D", ToggleSecureMode, On
    Hotkey, % baseHotkey " & ,", OpenSettings, On
    Hotkey, % baseHotkey " & =", OpenCustomHotkeysGUI, On
} catch e {
    MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ø®ØªØµØ§Ø±Ø§Øª Flx Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:`nØ§Ù„Ø³Ø¨Ø¨: %e%
}

; ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ù…Ø¹ Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø§ÙØ°Ø©
CustomHotkeys := {}
IniRead, customKeys, %iniFile%, CustomHotkeys
if (customKeys = "ERROR") {
    customKeys := ""
}
Loop, Parse, customKeys, `n
{
    if (A_LoopField = "")
        continue
    KeyValue := StrSplit(A_LoopField, "=")
    if (KeyValue.Length() >= 2) {
        keyCond := Trim(KeyValue[1])
        keyCond := StrReplace(keyCond, """", "")
        action := Trim(SubStr(A_LoopField, InStr(A_LoopField, "=") + 1))
        if (InStr(keyCond, ";")) {
            keyCond := StrReplace(keyCond, ";", "VKBA")
        }
        SplitKeyCond := StrSplit(keyCond, "|")
        key := SplitKeyCond[1]
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : ""
        fullKey := key . (winCondition ? "|" . winCondition : "")
        if (CustomHotkeys.HasKey(fullKey)) {
            continue
        }
        CustomHotkeys[fullKey] := action
        baseKey := RegExReplace(key, "[+^!#]")
        try {
            Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
        } catch e {
            MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
        }
    }
}

; ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© Ù…Ø¹ Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø§ÙØ°Ø©
AdvancedScripts := {}
IniRead, advScripts, %iniFile%, AdvancedScripts
if (advScripts = "ERROR") {
    advScripts := ""
}
Loop, Parse, advScripts, `n
{
    if (A_LoopField = "")
        continue
    KeyValue := StrSplit(A_LoopField, "=")
    if (KeyValue.Length() >= 2) {
        keyCond := Trim(KeyValue[1])
        keyCond := StrReplace(keyCond, """", "")
        scriptPath := Trim(SubStr(A_LoopField, InStr(A_LoopField, "=") + 1))
        if (InStr(keyCond, ";")) {
            keyCond := StrReplace(keyCond, ";", "VKBA")
        }
        SplitKeyCond := StrSplit(keyCond, "|")
        key := SplitKeyCond[1]
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : ""
        fullKey := key . (winCondition ? "|" . winCondition : "")
        if (AdvancedScripts.HasKey(fullKey)) {
            continue
        }
        fullPath := A_ScriptDir "\" scriptPath
        if FileExist(fullPath) {
            AdvancedScripts[fullKey] := scriptPath
            baseKey := RegExReplace(key, "[+^!#]")
            try {
                Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
            } catch e {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
            }
        } else {
            MsgBox, 48, ØªØ­Ø°ÙŠØ±, Ù…Ù„Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %scriptPath%
        }
    }
}

; ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø¨Ø¯ÙˆÙ† Flx Ù…Ø¹ Ø´Ø±ÙˆØ· Ø§Ù„Ù†Ø§ÙØ°Ø©
NoFlxHotkeys := {}
HotkeyConditions := {}
IniRead, noFlxKeys, %iniFile%, NoFlx
if (noFlxKeys = "ERROR") {
    noFlxKeys := ""
}
Loop, Parse, noFlxKeys, `n
{
    if (A_LoopField = "")
        continue
    KeyValue := StrSplit(A_LoopField, "=")
    if (KeyValue.Length() >= 2) {
        keyCond := Trim(KeyValue[1])
        keyCond := StrReplace(keyCond, """", "")
        action := Trim(SubStr(A_LoopField, InStr(A_LoopField, "=") + 1))
        if (InStr(keyCond, ";")) {
            keyCond := StrReplace(keyCond, ";", "VKBA")
        }
        SplitKeyCond := StrSplit(keyCond, "|")
        key := SplitKeyCond[1]
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : ""
        fullKey := key . (winCondition ? "|" . winCondition : "")
        if (NoFlxHotkeys.HasKey(fullKey)) {
            continue
        }
        NoFlxHotkeys[fullKey] := action
        if (!HotkeyConditions.HasKey(key)) {
            HotkeyConditions[key] := {}
        }
        HotkeyConditions[key][fullKey] := winCondition
        try {
            ; ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¥Ø°Ø§ ÙˆØ¬Ø¯
            if (winCondition) {
                Hotkey, IfWinActive, %winCondition%
                Hotkey, %key%, ExecuteNoFlxHotkeyConditional, On
                Hotkey, IfWinActive  ; Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø³ÙŠØ§Ù‚
            } else {
                Hotkey, %key%, ExecuteNoFlxHotkeyConditional, On
            }
        } catch e {
            MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„: %key%`nØ§Ù„Ø³Ø¨Ø¨: %e%
        }
    }
}

; ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø¨Ø¯ÙˆÙ† Flx Ù…Ø¹ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø´Ø±Ø·
ExecuteNoFlxHotkeyConditional:
    global NoFlxHotkeys, HotkeyConditions, scriptsDir
    keyPressed := A_ThisHotkey
    WinGet, activeExe, ProcessName, A
    currentWinCondition := activeExe ? "ahk_exe " . activeExe : ""
    fullKeyWithCondition := keyPressed . (currentWinCondition ? "|" . currentWinCondition : "")
    fullKeyDefault := keyPressed

    ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ù…Ø¹ Ø§Ù„Ø´Ø±Ø· Ø£Ùˆ Ø¨Ø¯ÙˆÙ†Ù‡
    if (NoFlxHotkeys.HasKey(fullKeyWithCondition)) {
        action := NoFlxHotkeys[fullKeyWithCondition]
    } else if (NoFlxHotkeys.HasKey(fullKeyDefault)) {
        action := NoFlxHotkeys[fullKeyDefault]
    } else {
        ; Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ø§Ø®ØªØµØ§Ø± Ù…Ø·Ø§Ø¨Ù‚ØŒ Ù†ØªØ±Ùƒ Ø§Ù„Ù…ÙØªØ§Ø­ ÙŠÙ…Ø± Ø¨Ø´ÙƒÙ„ Ø·Ø¨ÙŠØ¹ÙŠ
        return
    }

    ; ØªÙ†ÙÙŠØ° Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡
    if (RegExMatch(action, "\.ahk$")) {
        fullPath := (InStr(action, "\") = 1 || InStr(action, ":") = 2) ? action : scriptsDir "\" action
        if FileExist(fullPath) {
            SetWorkingDir, %scriptsDir%
            Run, %A_AhkPath% "%fullPath%", , UseErrorLevel
            SetWorkingDir, %A_ScriptDir%
            if (A_LastError) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª: %fullPath%`nØ®Ø·Ø£: %A_LastError%
            }
        } else {
            MsgBox, 48, Ø®Ø·Ø£, Ù…Ù„Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullPath%
        }
    } else {
        ExecuteSingleAction(action)
    }
return

;------------------ Hotkeys ------------------
; ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… baseHotkey
try {
    Hotkey, %baseHotkey%, OpenInteractiveMode, On
    Hotkey, % baseHotkey " & D", ToggleSecureMode, On
    Hotkey, % baseHotkey " & ,", OpenSettings, On
    Hotkey, % baseHotkey " & =", OpenCustomHotkeysGUI, On
} catch e {
    MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ø®ØªØµØ§Ø±Ø§Øª Flx Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©:`nØ§Ù„Ø³Ø¨Ø¨: %e%
}

; ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø§Ù„Ø¥Ø¶Ø§ÙÙŠ Ctrl+Win+=
^#+=::
OpenCustomHotkeysGUI()
return

;------------------ Functions ------------------

OpenInteractiveMode:
    global baseHotkey
    ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù…ÙØªÙˆØ­Ø© Ø¨Ø§Ù„ÙØ¹Ù„
    IfWinExist, Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª
    {
        Gui, InteractiveMenu:Destroy
        return
    }
    ; Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…ÙØªÙˆØ­Ø©ØŒ Ø§ÙØªØ­Ù‡Ø§
    Gui, InteractiveMenu:Destroy  ; ØªØ¯Ù…ÙŠØ± Ø£ÙŠ Ù†Ø³Ø®Ø© Ù‚Ø¯ÙŠÙ…Ø© Ù„Ù„ØªØ£ÙƒØ¯
    Gui, InteractiveMenu:Color, 2D2D2D
    Gui, InteractiveMenu:Font, c000000 s10, Segoe UI
    Gui, InteractiveMenu:Add, Text, x10 y10 w300 h25 Center cFFD700, Ø§Ø®ØªØ± Ø§Ø®ØªØµØ§Ø±Ù‹Ø§
    Gui, InteractiveMenu:Add, ListBox, x10 y40 w300 h230 vSelectedHotkey gExecuteFromMenu, % GenerateHotkeyListForMenu()
    Gui, InteractiveMenu:Show, w320 h270, Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª
return

GenerateHotkeyListForMenu() {
    global CustomHotkeys, AdvancedScripts, NoFlxHotkeys, baseHotkey
    list := ""
    ; CustomHotkeys
    for fullKey, action in CustomHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        condition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : ""
        displayText := baseHotkey " & " . key . " - " . action . (condition ? " (" . condition . ")" : "")
        list .= displayText . "|"
    }
    ; AdvancedScripts
    for fullKey, scriptPath in AdvancedScripts {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        condition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : ""
        displayText := baseHotkey " & " . key . " - " . scriptPath . (condition ? " (" . condition . ")" : "")
        list .= displayText . "|"
    }
    ; NoFlxHotkeys
    for fullKey, action in NoFlxHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        condition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : ""
        displayText := key . " - " . action . (condition ? " (" . condition . ")" : "")
        list .= displayText . "|"
    }
    return RTrim(list, "|")
}

ExecuteFromMenu:
    global CustomHotkeys, AdvancedScripts, NoFlxHotkeys, baseHotkey, scriptsDir
    Gui, InteractiveMenu:Submit, NoHide
    if (SelectedHotkey = "") {
        return  ; Ù„Ø§ ØªÙØ¹Ù„ Ø´ÙŠØ¦Ù‹Ø§ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ø®ØªÙŠØ§Ø± Ø´ÙŠØ¡
    }
    SplitHotkey := StrSplit(SelectedHotkey, " - ")
    if (SplitHotkey.Length() < 2) {
        MsgBox, 48, Ø®Ø·Ø£, ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø§Ø®ØªØµØ§Ø± ØºÙŠØ± ØµØ§Ù„Ø­.
        return
    }
    keyDisplay := SplitHotkey[1]
    actionOrScript := SplitHotkey[2]
    
    ; Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø´Ø±Ø· Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§
    condition := ""
    if (InStr(actionOrScript, "(")) {
        conditionStart := InStr(actionOrScript, "(")
        conditionEnd := InStr(actionOrScript, ")",, -1)
        condition := SubStr(actionOrScript, conditionStart + 1, conditionEnd - conditionStart - 1)
        actionOrScript := Trim(SubStr(actionOrScript, 1, conditionStart - 1))
    }
    
    ; ØªØ­Ø¯ÙŠØ¯ Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø§Ø®ØªØµØ§Ø± ÙŠØ³ØªØ®Ø¯Ù… Flx Ø£Ù… Ù„Ø§
    isFlx := InStr(keyDisplay, baseHotkey " & ")
    key := isFlx ? StrReplace(keyDisplay, baseHotkey " & ") : keyDisplay
    fullKey := StrReplace(key, ";", "VKBA") . (condition ? "|" . condition : "")

    ; Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø£ÙˆÙ„Ø§Ù‹
    Gui, InteractiveMenu:Destroy
    
    ; Ø¥Ø¶Ø§ÙØ© ØªØ£Ø®ÙŠØ± 70 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© Ù„Ù„Ø³Ù…Ø§Ø­ Ù„Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© Ø¨Ø£Ù† ØªØµØ¨Ø­ Ù†Ø´Ø·Ø©
    Sleep, 70

    ; ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ù…ØµØ¯Ø±Ù‡
    if (isFlx && CustomHotkeys.HasKey(fullKey)) {
        action := CustomHotkeys[fullKey]
        ExecuteSingleAction(action)
    } else if (isFlx && AdvancedScripts.HasKey(fullKey)) {
        scriptPath := AdvancedScripts[fullKey]
        fullPath := A_ScriptDir "\" scriptPath
        if FileExist(fullPath) {
            SetWorkingDir, %scriptsDir%
            Run, %A_AhkPath% "%fullPath%", , UseErrorLevel
            SetWorkingDir, %A_ScriptDir%
            if (A_LastError) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª: %fullPath%`nØ®Ø·Ø£: %A_LastError%
            }
        } else {
            MsgBox, 48, Ø®Ø·Ø£, Ù…Ù„Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullPath%
        }
    } else if (!isFlx && NoFlxHotkeys.HasKey(fullKey)) {
        action := NoFlxHotkeys[fullKey]
        ExecuteSingleAction(action)
    } else {
        MsgBox, 48, Ø®Ø·Ø£, Ø§Ù„Ø§Ø®ØªØµØ§Ø± ØºÙŠØ± Ù…Ø¹Ø±Ù: %fullKey%
    }
return

CancelInteractiveMenu:
    Gui, InteractiveMenu:Destroy
return

OpenCustomHotkeysGUI() {
    global iniFile, CustomHotkeys, AdvancedScripts, baseHotkey, NoFlxHotkeys, scriptsDir
    Gui, CustomHotkeys:Destroy
    Gui, CustomHotkeys:Color, 2D2D2D
    Gui, CustomHotkeys:Font, cFFFFFF s10, Segoe UI
    Gui, CustomHotkeys:Add, Tab3, x0 y0 w650 h450, Ø£Ø³Ø§Ø³ÙŠ|Ù…ØªÙ‚Ø¯Ù…
    Gui, CustomHotkeys:Tab, Ø£Ø³Ø§Ø³ÙŠ
    Gui, CustomHotkeys:Add, Text, x20 y50 w610 h30 Center cFFD700, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø¨Ø³Ù‡ÙˆÙ„Ø©
    Gui, CustomHotkeys:Add, Text, x20 y90 w150 h25, Ø§Ù„Ù…ÙØªØ§Ø­ (Ù…Ø«Ù„ T Ø£Ùˆ \):
    Gui, CustomHotkeys:Add, Edit, x180 y90 w150 h25 vHotkeyKey c000000 Background424242,
    Gui, CustomHotkeys:Add, Text, x340 y90 w300 h50 cA0A0A0, ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù…ÙˆØ² Ù…Ø«Ù„ = Ø£Ùˆ , Ø£ÙŠØ¶Ø§Ù‹
    Gui, CustomHotkeys:Add, CheckBox, x20 y120 w60 h25 vUseFlx Checked, Flx
    Gui, CustomHotkeys:Add, CheckBox, x90 y120 w60 h25 vUseCtrl, Ctrl
    Gui, CustomHotkeys:Add, CheckBox, x160 y120 w60 h25 vUseShift, Shift
    Gui, CustomHotkeys:Add, CheckBox, x230 y120 w60 h25 vUseAlt, Alt
    Gui, CustomHotkeys:Add, CheckBox, x300 y120 w60 h25 vUseWin, Win
    Gui, CustomHotkeys:Add, Text, x20 y150 w150 h25, Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†Ø´Ø·Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):
    Gui, CustomHotkeys:Add, Edit, x180 y150 w300 h25 vWinCondition c000000 Background424242,
    Gui, CustomHotkeys:Add, Button, x490 y150 w80 h25 gBrowseWinCondition, ØªØµÙØ­
    Gui, CustomHotkeys:Add, Button, x20 y180 w150 h40 gAddAppHotkey, ÙØªØ­ ØªØ·Ø¨ÙŠÙ‚
    Gui, CustomHotkeys:Add, Button, x20 y230 w150 h40 gOpenTextInput, Ø¥Ø±Ø³Ø§Ù„ Ù†Øµ
    Gui, CustomHotkeys:Add, Button, x340 y180 w150 h40 gOpenFileHotkey, ÙØªØ­ Ù…Ù„Ù 
    Gui, CustomHotkeys:Add, Button, x180 y180 w150 h40 gOpenFolderHotkey, ÙØªØ­ Ù…Ø¬Ù„Ø¯
    Gui, CustomHotkeys:Add, Button, x180 y230 w150 h40 gOpenHotkeyManagerGUI, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª
    Gui, CustomHotkeys:Tab, Ù…ØªÙ‚Ø¯Ù…
    Gui, CustomHotkeys:Add, Text, x20 y50 w610 h30 Center cFFD700, Ø®ÙŠØ§Ø±Ø§Øª Ù…ØªÙ‚Ø¯Ù…Ø©
    Gui, CustomHotkeys:Add, Text, x20 y75 w150 h50, Ø²Ø± Ø§Ù„Flx (Ù…Ø«Ù„ SC056):
    Gui, CustomHotkeys:Add, Edit, x180 y90 w150 h25 vBaseHotkeyInput c000000 Background424242, %baseHotkey%
    Gui, CustomHotkeys:Add, Button, x340 y90 w150 h25 gSaveBaseHotkey, Ø­ÙØ¸ Ø²Ø± Ø§Ù„Flx
    Gui, CustomHotkeys:Add, Text, x20 y110 w150 h50, Ø§Ù„Ù…ÙØªØ§Ø­ (Ù…Ø«Ù„ T) Ø§Ùˆ Ø§Ø¶ØºØ· Ø§ÙƒØªØ´Ø§Ù:
    Gui, CustomHotkeys:Add, Edit, x180 y120 w150 h25 vAdvHotkeyKey c000000 Background424242,
    Gui, CustomHotkeys:Add, Button, x340 y120 w100 h25 gDetectKey, Ø§ÙƒØªØ´Ø§Ù Ø§Ù„Ù…ÙØªØ§Ø­
    Gui, CustomHotkeys:Add, Text, x450 y120 w190 h50 cA0A0A0, ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø±Ù…ÙˆØ² Ù…Ø«Ù„ = Ø£Ùˆ , Ø£ÙŠØ¶Ø§Ù‹
    Gui, CustomHotkeys:Add, CheckBox, x20 y150 w60 h25 vAdvUseFlx Checked, Flx
    Gui, CustomHotkeys:Add, CheckBox, x90 y150 w60 h25 vAdvUseCtrl, Ctrl
    Gui, CustomHotkeys:Add, CheckBox, x160 y150 w60 h25 vAdvUseShift, Shift
    Gui, CustomHotkeys:Add, CheckBox, x230 y150 w60 h25 vAdvUseAlt, Alt
    Gui, CustomHotkeys:Add, CheckBox, x300 y150 w60 h25 vAdvUseWin, Win
    Gui, CustomHotkeys:Add, Text, x20 y180 w150 h25, Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†Ø´Ø·Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):
    Gui, CustomHotkeys:Add, Edit, x180 y180 w300 h25 vAdvWinCondition c000000 Background424242,
    Gui, CustomHotkeys:Add, Button, x490 y180 w80 h25 gBrowseWinConditionAdv, ØªØµÙØ­
    Gui, CustomHotkeys:Add, Text, x20 y210 w150 h25, Ø§Ù„Ø³ÙƒØ±Ø¨Øª (ÙƒÙˆØ¯ AHK ÙƒØ§Ù…Ù„):
    Gui, CustomHotkeys:Add, Edit, x180 y210 w300 h80 vAdvHotkeyScript c000000 Background424242 Multi,
    Gui, CustomHotkeys:Add, Button, x490 y210 w80 h25 gBrowseAdvAction, ØªØµÙØ­
    Gui, CustomHotkeys:Add, Text, x20 y300 w150 h25, Ø§Ø®ØªØ± Ø³ÙƒØ±Ø¨Øª Ù…ÙˆØ¬ÙˆØ¯:
    Gui, CustomHotkeys:Add, DropDownList, x180 y300 w300 h25 R10 vSelectedScript c000000 Background424242 gLoadSelectedScript, % GetScriptList()
    Gui, CustomHotkeys:Add, Button, x490 y300 w80 h25 gLoadSelectedScript, ØªØ­Ù…ÙŠÙ„
    Gui, CustomHotkeys:Add, Button, x180 y340 w100 h30 gAddAdvHotkey, Ø¥Ø¶Ø§ÙØ©
    Gui, CustomHotkeys:Add, Button, x340 y340 w100 h30 gOpenHotkeyManagerGUI, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¥Ø®ØªØµØ§Ø±Ø§Øª
    Gui, CustomHotkeys:Show, w650 h450, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª
}

GetScriptList() {
    global scriptsDir
    scriptList := ""
    Loop, Files, %scriptsDir%\*.ahk
    {
        SplitPath, A_LoopFileName,,,, scriptName  ; ÙŠÙØ±Ø¬Ø¹ Ø§Ù„Ø§Ø³Ù… Ø¨Ø¯ÙˆÙ† .ahk
        scriptList .= scriptName "|"
    }
    return RTrim(scriptList, "|")
}

LoadSelectedScript:
    Gui, CustomHotkeys:Submit, NoHide
    if (SelectedScript != "") {
        fullPath := scriptsDir "\" SelectedScript ".ahk"
        if FileExist(fullPath) {
            FileRead, scriptContent, %fullPath%
            GuiControl, CustomHotkeys:, AdvHotkeyScript, %scriptContent%  ; Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ØªØ­Ù‚Ù‚ ÙÙ‚Ø·
        } else {
            MsgBox, 48, Ø®Ø·Ø£, Ø§Ù„Ø³ÙƒØ±Ø¨Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullPath%
        }
    }
return

BrowseWinCondition:
BrowseWinConditionAdv:
    ; ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø©
    Gui, CustomHotkeys:Submit, NoHide
    ; Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ø¹Ù†ÙŠØ© Ù…Ø¤Ù‚ØªÙ‹Ø§
    Gui, CustomHotkeys:Hide
    Gui, HotkeyManager:Hide

    MsgBox, 64, ØªØ¹Ù„ÙŠÙ…Ø§Øª, Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø§Ø®ØªÙŠØ§Ø±Ù‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ù…ÙˆØ§ÙÙ‚". Ø³ÙŠØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù…Ø¤Ù‚ØªÙ‹Ø§ Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±.
    KeyWait, LButton, D T10
    if (ErrorLevel) {
        MsgBox, 48, Ø®Ø·Ø£, Ù„Ù… ÙŠØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠ Ù†Ø§ÙØ°Ø© Ø®Ù„Ø§Ù„ 10 Ø«ÙˆØ§Ù†Ù.
        Gui, CustomHotkeys:Show
        Gui, HotkeyManager:Show
        return
    }
    MouseGetPos,,, windowID
    WinGet, activeExe, ProcessName, ahk_id %windowID%
    if (activeExe) {
        condition := "ahk_exe " . activeExe
        if (A_ThisLabel = "BrowseWinCondition") {
            GuiControl, CustomHotkeys:, WinCondition, %condition%
        } else {
            GuiControl, CustomHotkeys:, AdvWinCondition, %condition%
        }
    } else {
        MsgBox, 48, Ø®Ø·Ø£, Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù…Ù„ÙŠØ© Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©.
    }
    ; Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„ØªÙŠ Ø£ÙØ®ÙÙŠØª
    Gui, CustomHotkeys:Show
    Gui, HotkeyManager:Show
return

SaveBaseHotkey:
    global baseHotkey, iniFile, CustomHotkeys, AdvancedScripts
    Gui, CustomHotkeys:Submit, NoHide
    if (BaseHotkeyInput = "") {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­ Ø£Ø³Ø§Ø³ÙŠ.
        return
    }
    oldBaseHotkey := baseHotkey
    baseHotkey := BaseHotkeyInput
    IniWrite, %baseHotkey%, %iniFile%, HotkeySettings, BaseKey
    ReloadHotkeys(oldBaseHotkey)
    MsgBox, 64, ØªÙ…, ØªÙ… ØªØºÙŠÙŠØ± Ø²Ø± Ø§Ù„Flx Ø¥Ù„Ù‰ %baseHotkey% ÙˆØ¥Ø¹Ø§Ø¯Ø© ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø¨Ù†Ø¬Ø§Ø­!
return

ReloadHotkeys(oldBaseHotkey) {
    global baseHotkey, CustomHotkeys, AdvancedScripts, NoFlxHotkeys
    ; ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù„Ù€ CustomHotkeys Ùˆ AdvancedScripts
    for fullKey in CustomHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := SplitKeyCond[1]
        baseKey := RegExReplace(key, "[+^!#]")
        try {
            Hotkey, % oldBaseHotkey " & " . baseKey, Off
        } catch e {
            ; ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù…Ø¹Ø±ÙÙ‹Ø§
        }
    }
    for fullKey in AdvancedScripts {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := SplitKeyCond[1]
        baseKey := RegExReplace(key, "[+^!#]")
        try {
            Hotkey, % oldBaseHotkey " & " . baseKey, Off
        } catch e {
            ; ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
        }
    }
    ; ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
    try {
        Hotkey, %oldBaseHotkey%, Off
        Hotkey, % oldBaseHotkey " & D", Off
        Hotkey, % oldBaseHotkey " & ,", Off
        Hotkey, % oldBaseHotkey " & =", Off
        Hotkey, % oldBaseHotkey " & X", Off
    } catch e {
        ; ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
    }
    ; ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù€ CustomHotkeys Ùˆ AdvancedScripts
    for fullKey in CustomHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := SplitKeyCond[1]
        baseKey := RegExReplace(key, "[+^!#]")
        try {
            Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
        } catch e {
            MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø±: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
        }
    }
    for fullKey in AdvancedScripts {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := SplitKeyCond[1]
        baseKey := RegExReplace(key, "[+^!#]")
        try {
            Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
        } catch e {
            MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
        }
    }
    ; ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
    try {
        Hotkey, %baseHotkey%, OpenInteractiveMode, On
        Hotkey, % baseHotkey " & D", ToggleSecureMode, On
        Hotkey, % baseHotkey " & ,", OpenSettings, On
        Hotkey, % baseHotkey " & =", OpenCustomHotkeysGUI, On
    } catch e {
        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ©: %e%
    }
}

DetectKey:
    Gui, CustomHotkeys:+Disabled
    detectedKey := ""
    Loop, 255 {
        scanCode := Format("SC{:03X}", A_Index)
        if GetKeyState(scanCode, "P") {
            detectedKey := scanCode
            break
        }
        vkCode := Format("VK{:02X}", A_Index)
        if GetKeyState(vkCode, "P") {
            detectedKey := vkCode
            break
        }
    }
    if (detectedKey = "") {
        SetTimer, CheckKeyTimeout, 10000
        Loop {
            Loop, 255 {
                scanCode := Format("SC{:03X}", A_Index)
                if GetKeyState(scanCode, "P") {
                    detectedKey := scanCode
                    break 2
                }
                vkCode := Format("VK{:02X}", A_Index)
                if GetKeyState(vkCode, "P") {
                    detectedKey := vkCode
                    break 2
                }
            }
            Sleep, 50
        }
    }
    SetTimer, CheckKeyTimeout, Off
    if (detectedKey = "") {
        MsgBox, 48, Ø®Ø·Ø£, Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ Ø£ÙŠ Ù…ÙØªØ§Ø­ Ø®Ù„Ø§Ù„ 10 Ø«ÙˆØ§Ù†Ù.
    } else {
        detectedKey := RegExReplace(detectedKey, "[+^!#]")
        GuiControl, CustomHotkeys:, AdvHotkeyKey, %detectedKey%
    }
    Gui, CustomHotkeys:-Disabled
return

CheckKeyTimeout:
    detectedKey := ""
return

GenerateHotkeyList() {
    global CustomHotkeys, AdvancedScripts, NoFlxHotkeys
    hotkeyList := ""
    for fullKey, action in CustomHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := SplitKeyCond[1]
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        hotkeyList .= key . " | " . winCondition . " = " . action . " (Flx)`n"
    }
    for fullKey, script in AdvancedScripts {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := SplitKeyCond[1]
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        hotkeyList .= key . " | " . winCondition . " = " . script . " (Flx)`n"
    }
    for fullKey, action in NoFlxHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := SplitKeyCond[1]
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        hotkeyList .= key . " | " . winCondition . " = " . action . " (NoFlx)`n"
    }
    return hotkeyList
}

AddAppHotkey:
    Gui, CustomHotkeys:Submit, NoHide
    if (HotkeyKey = "") {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­.
        return
    }
    modifierPrefix := (UseFlx ? "" : "") . (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "")
    key := modifierPrefix . HotkeyKey
    fullKey := key . (WinCondition ? "|" . WinCondition : "")
    if (UseFlx && (CustomHotkeys.HasKey(fullKey) || AdvancedScripts.HasKey(fullKey))) {
        oldAction := CustomHotkeys[fullKey] ? CustomHotkeys[fullKey] : AdvancedScripts[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %WinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    } else if (!UseFlx && NoFlxHotkeys.HasKey(fullKey)) {
        oldAction := NoFlxHotkeys[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %WinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    }
    ; Ù†Ø§ÙØ°Ø© Ø§Ø®ØªÙŠØ§Ø± Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¥Ø¶Ø§ÙØ©
    Gui, AppInput:Destroy
    Gui, AppInput:Color, 2D2D2D
    Gui, AppInput:Font, cFFFFFF s10, Segoe UI
    Gui, AppInput:Add, Text, x20 y20 w300 h25, Ø§Ø®ØªØ± Ø·Ø±ÙŠÙ‚Ø© Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚:
    Gui, AppInput:Add, Button, x20 y50 w150 h30 gBrowseAppFile, Ø§Ø®ØªÙŠØ§Ø± Ù…Ù„Ù ØªØ·Ø¨ÙŠÙ‚
    Gui, AppInput:Add, Button, x180 y50 w150 h30 gManualAppInput, Ø¥Ø¯Ø®Ø§Ù„ Ø£Ù…Ø± ÙŠØ¯ÙˆÙŠ
    Gui, AppInput:Add, Button, x100 y90 w100 h30 gCancelAppInput, Ø¥Ù„ØºØ§Ø¡
    Gui, AppInput:Show, w340 h130, Ø¥Ø¶Ø§ÙØ© ØªØ·Ø¨ÙŠÙ‚ Ù„Ù„Ø§Ø®ØªØµØ§Ø±
return

BrowseAppFile:
    Gui, AppInput:Destroy
    FileSelectFile, selectedFile, 3, , Ø§Ø®ØªØ± ØªØ·Ø¨ÙŠÙ‚Ù‹Ø§ Ù„ÙØªØ­Ù‡, Executable Files (*.exe)
    if (selectedFile != "") {
        Gui, CustomHotkeys:Submit, NoHide
        if (UseFlx) {
            oldHotkeyCount := CustomHotkeys.Count()
            AddHotkey(HotkeyKey, "Run " . selectedFile, UseCtrl, UseShift, UseAlt, UseWin, UseFlx, WinCondition)
            if (CustomHotkeys.Count() > oldHotkeyCount || CustomHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø±.
            }
        } else {
            oldHotkeyCount := NoFlxHotkeys.Count()
            AddNoFlxHotkey(HotkeyKey, "Run " . selectedFile, UseCtrl, UseShift, UseAlt, UseWin, WinCondition)
            if (NoFlxHotkeys.Count() > oldHotkeyCount || NoFlxHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx.
            }
        }
    }
return

ManualAppInput:
    Gui, AppInput:Destroy
    Gui, ManualInput:Destroy
    Gui, ManualInput:Color, 2D2D2D
    Gui, ManualInput:Font, cFFFFFF s10, Segoe UI
    Gui, ManualInput:Add, Text, x20 y20 w300 h25, Ø£Ø¯Ø®Ù„ Ø£Ù…Ø± Ø§Ù„ØªØ´ØºÙŠÙ„ (Ù…Ø«Ù„ explorer.exe shell:...):
    Gui, ManualInput:Add, Edit, x20 y50 w400 h25 vManualCommand c000000 Background424242,
    Gui, ManualInput:Add, Button, x170 y80 w100 h30 gSaveManualCommand, Ø­ÙØ¸
    Gui, ManualInput:Add, Button, x280 y80 w100 h30 gCancelManualInput, Ø¥Ù„ØºØ§Ø¡
    Gui, ManualInput:Show, w440 h120, Ø¥Ø¯Ø®Ø§Ù„ Ø£Ù…Ø± ÙŠØ¯ÙˆÙŠ
return

SaveManualCommand:
    Gui, ManualInput:Submit
    if (ManualCommand != "") {
        Gui, CustomHotkeys:Submit, NoHide
        if (UseFlx) {
            oldHotkeyCount := CustomHotkeys.Count()
            AddHotkey(HotkeyKey, "Run " . ManualCommand, UseCtrl, UseShift, UseAlt, UseWin, UseFlx, WinCondition)
            if (CustomHotkeys.Count() > oldHotkeyCount || CustomHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                Gui, ManualInput:Destroy
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø±.
                Gui, ManualInput:Destroy
            }
        } else {
            oldHotkeyCount := NoFlxHotkeys.Count()
            AddNoFlxHotkey(HotkeyKey, "Run " . ManualCommand, UseCtrl, UseShift, UseAlt, UseWin, WinCondition)
            if (NoFlxHotkeys.Count() > oldHotkeyCount || NoFlxHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                Gui, ManualInput:Destroy
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx.
                Gui, ManualInput:Destroy
            }
        }
    } else {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø£Ù…Ø± ØªØ´ØºÙŠÙ„.
    }
return

CancelManualInput:
    Gui, ManualInput:Destroy
return

CancelAppInput:
    Gui, AppInput:Destroy
return
    FileSelectFile, selectedFile, 3, , Ø§Ø®ØªØ± ØªØ·Ø¨ÙŠÙ‚Ù‹Ø§ Ù„ÙØªØ­Ù‡, Executable Files (*.exe)
    if (selectedFile != "") {
        if (UseFlx) {
            oldHotkeyCount := CustomHotkeys.Count()
            AddHotkey(HotkeyKey, "Run " . selectedFile, UseCtrl, UseShift, UseAlt, UseWin, UseFlx, WinCondition)
            if (CustomHotkeys.Count() > oldHotkeyCount || CustomHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø±.
            }
        } else {
            oldHotkeyCount := NoFlxHotkeys.Count()
            AddNoFlxHotkey(HotkeyKey, "Run " . selectedFile, UseCtrl, UseShift, UseAlt, UseWin, WinCondition)
            if (NoFlxHotkeys.Count() > oldHotkeyCount || NoFlxHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx.
            }
        }
    }
return

OpenTextInput:
    Gui, CustomHotkeys:Submit, NoHide
    if (HotkeyKey = "") {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­.
        return
    }
    modifierPrefix := (UseFlx ? "" : "") . (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "")
    key := modifierPrefix . HotkeyKey
    fullKey := key . (WinCondition ? "|" . WinCondition : "")
    if (UseFlx && (CustomHotkeys.HasKey(fullKey) || AdvancedScripts.HasKey(fullKey))) {
        oldAction := CustomHotkeys[fullKey] ? CustomHotkeys[fullKey] : AdvancedScripts[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %WinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    } else if (!UseFlx && NoFlxHotkeys.HasKey(fullKey)) {
        oldAction := NoFlxHotkeys[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %WinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    }
    Gui, TextInput:Destroy
    Gui, TextInput:Color, 2D2D2D
    Gui, TextInput:Font, cFFFFFF s10, Segoe UI
    Gui, TextInput:Add, Text, x20 y20 w150 h25, Ø£Ø¯Ø®Ù„ Ø§Ù„Ù†Øµ Ù„Ø¥Ø±Ø³Ø§Ù„Ù‡:
    Gui, TextInput:Add, Edit, x180 y20 w300 h25 vTextToSend c000000 Background424242,
    Gui, TextInput:Add, Text, x20 y50 w460 h20 cA0A0A0, Ù…Ù„Ø§Ø­Ø¸Ø©: ÙŠÙ…ÙƒÙ†Ùƒ Ø£ÙŠØ¶Ù‹Ø§ Ø¥Ø¯Ø®Ø§Ù„ Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ù…Ø«Ù„ ğŸ˜Š Ø£Ùˆ ğŸ‘ Ù‡Ù†Ø§
    Gui, TextInput:Add, Button, x180 y80 w100 h30 gSaveTextHotkey, Ø­ÙØ¸
    Gui, TextInput:Add, Button, x290 y80 w100 h30 gCancelTextInput, Ø¥Ù„ØºØ§Ø¡
    Gui, TextInput:Show, w500 h120, Ø¥Ø±Ø³Ø§Ù„ Ù†Øµ Ù„Ù„Ø§Ø®ØªØµØ§Ø±
return

SaveTextHotkey:
    Gui, TextInput:Submit
    if (TextToSend != "") {
        Gui, CustomHotkeys:Submit, NoHide
        if (UseFlx) {
            oldHotkeyCount := CustomHotkeys.Count()
            AddHotkey(HotkeyKey, "Send " . TextToSend, UseCtrl, UseShift, UseAlt, UseWin, UseFlx, WinCondition)
            fullKey := (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "") . HotkeyKey . (WinCondition ? "|" . WinCondition : "")
            if (CustomHotkeys.Count() > oldHotkeyCount || CustomHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                Gui, TextInput:Destroy
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø±.
                Gui, TextInput:Destroy
            }
        } else {
            oldHotkeyCount := NoFlxHotkeys.Count()
            AddNoFlxHotkey(HotkeyKey, "Send " . TextToSend, UseCtrl, UseShift, UseAlt, UseWin, WinCondition)
            fullKey := (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "") . HotkeyKey . (WinCondition ? "|" . WinCondition : "")
            if (NoFlxHotkeys.Count() > oldHotkeyCount || NoFlxHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                Gui, TextInput:Destroy
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx.
                Gui, TextInput:Destroy
            }
        }
    } else {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù†Øµ.
        Gui, TextInput:Destroy
    }
return

CancelTextInput:
    Gui, TextInput:Destroy
return

OpenFileHotkey:
    Gui, CustomHotkeys:Submit, NoHide
    if (HotkeyKey = "") {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­.
        return
    }
    modifierPrefix := (UseFlx ? "" : "") . (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "")
    key := modifierPrefix . HotkeyKey
    fullKey := key . (WinCondition ? "|" . WinCondition : "")
    if (UseFlx && (CustomHotkeys.HasKey(fullKey) || AdvancedScripts.HasKey(fullKey))) {
        oldAction := CustomHotkeys[fullKey] ? CustomHotkeys[fullKey] : AdvancedScripts[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %WinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    } else if (!UseFlx && NoFlxHotkeys.HasKey(fullKey)) {
        oldAction := NoFlxHotkeys[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %WinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    }
    FileSelectFile, selectedFile, 3, , Ø§Ø®ØªØ± Ù…Ù„ÙÙ‹Ø§ Ù„ÙØªØ­Ù‡, All Files (*.*)
    if (selectedFile != "") {
        if (UseFlx) {
            oldHotkeyCount := CustomHotkeys.Count()
            AddHotkey(HotkeyKey, "Run " . selectedFile, UseCtrl, UseShift, UseAlt, UseWin, UseFlx, WinCondition)
            if (CustomHotkeys.Count() > oldHotkeyCount || CustomHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ù„ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø±.
            }
        } else {
            oldHotkeyCount := NoFlxHotkeys.Count()
            AddNoFlxHotkey(HotkeyKey, "Run " . selectedFile, UseCtrl, UseShift, UseAlt, UseWin, WinCondition)
            if (NoFlxHotkeys.Count() > oldHotkeyCount || NoFlxHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx Ù„ÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx.
            }
        }
    }
return

OpenFolderHotkey:
    Gui, CustomHotkeys:Submit, NoHide
    if (HotkeyKey = "") {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­.
        return
    }
    modifierPrefix := (UseFlx ? "" : "") . (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "")
    key := modifierPrefix . HotkeyKey
    fullKey := key . (WinCondition ? "|" . WinCondition : "")
    if (UseFlx && (CustomHotkeys.HasKey(fullKey) || AdvancedScripts.HasKey(fullKey))) {
        oldAction := CustomHotkeys[fullKey] ? CustomHotkeys[fullKey] : AdvancedScripts[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %WinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    } else if (!UseFlx && NoFlxHotkeys.HasKey(fullKey)) {
        oldAction := NoFlxHotkeys[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %WinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    }
    Gui, FolderInput:Destroy
    Gui, FolderInput:Color, 2D2D2D
    Gui, FolderInput:Font, cFFFFFF s10, Segoe UI
    Gui, FolderInput:Add, Text, x20 y20 w150 h25, Ø£Ø¯Ø®Ù„ Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ø¬Ù„Ø¯:
    Gui, FolderInput:Add, Edit, x180 y20 w300 h25 vFolderPath c000000 Background424242,
    Gui, FolderInput:Add, Button, x490 y20 w80 h25 gBrowseFolder, ØªØµÙØ­
    Gui, FolderInput:Add, Button, x180 y60 w100 h30 gSaveFolderHotkey, Ø­ÙØ¸
    Gui, FolderInput:Add, Button, x290 y60 w100 h30 gCancelFolderInput, Ø¥Ù„ØºØ§Ø¡
    Gui, FolderInput:Show, w600 h100, ÙØªØ­ Ù…Ø¬Ù„Ø¯ Ù„Ù„Ø§Ø®ØªØµØ§Ø±
return

BrowseFolder:
    Gui, FolderInput:Submit, NoHide
    FileSelectFolder, selectedFolder, , 3, Ø§Ø®ØªØ± Ù…Ø¬Ù„Ø¯Ù‹Ø§ Ù„ÙØªØ­Ù‡
    if (selectedFolder != "") {
        GuiControl, FolderInput:, FolderPath, %selectedFolder%
    }
return

SaveFolderHotkey:
    Gui, FolderInput:Submit
    if (FolderPath != "") {
        Gui, CustomHotkeys:Submit, NoHide
        if (UseFlx) {
            oldHotkeyCount := CustomHotkeys.Count()
            AddHotkey(HotkeyKey, "Run " . FolderPath, UseCtrl, UseShift, UseAlt, UseWin, UseFlx, WinCondition)
            fullKey := (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "") . HotkeyKey . (WinCondition ? "|" . WinCondition : "")
            if (CustomHotkeys.Count() > oldHotkeyCount || CustomHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                Gui, FolderInput:Destroy
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø±.
                Gui, FolderInput:Destroy
            }
        } else {
            oldHotkeyCount := NoFlxHotkeys.Count()
            AddNoFlxHotkey(HotkeyKey, "Run " . FolderPath, UseCtrl, UseShift, UseAlt, UseWin, WinCondition)
            fullKey := (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "") . HotkeyKey . (WinCondition ? "|" . WinCondition : "")
            if (NoFlxHotkeys.Count() > oldHotkeyCount || NoFlxHotkeys.HasKey(fullKey)) {
                GuiControl, CustomHotkeys:, HotkeyKey,
                GuiControl, CustomHotkeys:, WinCondition,
                GuiControl, CustomHotkeys:, UseFlx, 1
                GuiControl, CustomHotkeys:, UseCtrl, 0
                GuiControl, CustomHotkeys:, UseShift, 0
                GuiControl, CustomHotkeys:, UseAlt, 0
                GuiControl, CustomHotkeys:, UseWin, 0
                Gui, FolderInput:Destroy
                MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx Ø¨Ù†Ø¬Ø§Ø­!
            } else {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx.
                Gui, FolderInput:Destroy
            }
        }
    } else {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø³Ø§Ø± Ù…Ø¬Ù„Ø¯ Ø£Ùˆ Ø§Ø®ØªÙŠØ§Ø± ÙˆØ§Ø­Ø¯.
        Gui, FolderInput:Destroy
    }
return

CancelFolderInput:
    Gui, FolderInput:Destroy
return
AddAdvHotkey:
    global AdvancedScripts, iniFile, baseHotkey, scriptsDir, NoFlxHotkeys
    Gui, CustomHotkeys:Submit, NoHide
    if (AdvHotkeyKey = "") {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­.
        return
    }
    modifierPrefix := (AdvUseFlx ? "" : "") . (AdvUseCtrl ? "^" : "") . (AdvUseShift ? "+" : "") . (AdvUseAlt ? "!" : "") . (AdvUseWin ? "#" : "")
    key := modifierPrefix . AdvHotkeyKey
    fullKey := key . (AdvWinCondition ? "|" . AdvWinCondition : "")
    
    ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ù…Ø³Ø¨Ù‚Ù‹Ø§
    if (AdvUseFlx && (CustomHotkeys.HasKey(fullKey) || AdvancedScripts.HasKey(fullKey))) {
        oldAction := CustomHotkeys[fullKey] ? CustomHotkeys[fullKey] : AdvancedScripts[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %AdvWinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    } else if (!AdvUseFlx && NoFlxHotkeys.HasKey(fullKey)) {
        oldAction := NoFlxHotkeys[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %AdvWinCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
    }

    if (AdvUseFlx) {
        ; [Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù€ Flx ÙŠØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡Ùˆ]
        if (SelectedScript != "") {
            scriptPath := "Scripts\" SelectedScript ".ahk"
            fullScriptPath := scriptsDir "\" SelectedScript ".ahk"
            if (!FileExist(fullScriptPath)) {
                MsgBox, 48, Ø®Ø·Ø£, Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…Ø®ØªØ§Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullScriptPath%
                return
            }
            ; Ø­Ø°Ù Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§
            if (AdvancedScripts.HasKey(fullKey)) {
                IniDelete, %iniFile%, AdvancedScripts, %fullKey%
            }
            IniWrite, %scriptPath%, %iniFile%, AdvancedScripts, %fullKey%
            AdvancedScripts[fullKey] := scriptPath
            baseKey := RegExReplace(key, "[+^!#]")
            try {
                Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
            } catch e {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
                return
            }
        }
        ; Ø¥Ø°Ø§ ØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø³ÙƒØ±Ø¨Øª ÙŠØ¯ÙˆÙŠÙ‹Ø§ ÙÙŠ Ø­Ù‚Ù„ Ø§Ù„Ù†Øµ
        else if (AdvHotkeyScript != "") {
            defaultScriptName := AdvHotkeyKey
            InputBox, scriptName, Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª, Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ù‹Ø§ Ù„Ù„Ø³ÙƒØ±Ø¨Øª (Ø¨Ø¯ÙˆÙ† .ahk):,, 300, 150,,,, %defaultScriptName%
            if (ErrorLevel || scriptName = "") {
                return
            }
            if (SubStr(scriptName, -3) != ".ahk") {
                scriptName .= ".ahk"
            }
            scriptPath := "Scripts\" scriptName
            fullScriptPath := scriptsDir "\" scriptName
            for existingKey, existingPath in AdvancedScripts {
                if (existingPath = scriptPath && existingKey != fullKey) {
                    MsgBox, 48, Ø®Ø·Ø£, Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª %scriptName% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ø§Ø®ØªØµØ§Ø± Ø¢Ø®Ø±.`nÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ù…Ø®ØªÙ„Ù.
                    return
                }
            }
            FileDelete, %fullScriptPath%
            FileAppend, %AdvHotkeyScript%, %fullScriptPath%, UTF-8
            if (ErrorLevel) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙÙŠ: %fullScriptPath%
                return
            }
            if (AdvancedScripts.HasKey(fullKey)) {
                oldScriptPath := AdvancedScripts[fullKey]
                if (oldScriptPath != scriptPath) {
                    FileDelete, % A_ScriptDir "\" oldScriptPath
                }
                IniDelete, %iniFile%, AdvancedScripts, %fullKey%
            }
            IniWrite, %scriptPath%, %iniFile%, AdvancedScripts, %fullKey%
            AdvancedScripts[fullKey] := scriptPath
            baseKey := RegExReplace(key, "[+^!#]")
            try {
                Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
            } catch e {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
                return
            }
        } else {
            MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø³ÙƒØ±Ø¨Øª Ø£Ùˆ Ø§Ø®ØªÙŠØ§Ø± ÙˆØ§Ø­Ø¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.
            return
        }
        
        ; Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø¶Ø§ÙØ©
        GuiControl, CustomHotkeys:, AdvHotkeyKey,
        GuiControl, CustomHotkeys:, AdvHotkeyScript,
        GuiControl, CustomHotkeys:, AdvWinCondition,
        GuiControl, CustomHotkeys:, AdvUseFlx, 1
        GuiControl, CustomHotkeys:, AdvUseCtrl, 0
        GuiControl, CustomHotkeys:, AdvUseShift, 0
        GuiControl, CustomHotkeys:, AdvUseAlt, 0
        GuiControl, CustomHotkeys:, AdvUseWin, 0
        GuiControl, CustomHotkeys:, SelectedScript, % "|" GetScriptList()
        MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù… Ø¨Ù†Ø¬Ø§Ø­!
    } else {
        ; Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx
        oldHotkeyCount := NoFlxHotkeys.Count()
        if (SelectedScript != "") {
            scriptPath := SelectedScript ".ahk"  ; Ø¨Ø¯ÙˆÙ† "Scripts\" Ù‡Ù†Ø§
            fullScriptPath := scriptsDir "\" scriptPath
            if (!FileExist(fullScriptPath)) {
                MsgBox, 48, Ø®Ø·Ø£, Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…Ø®ØªØ§Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullScriptPath%
                return
            }
            AddNoFlxHotkey(AdvHotkeyKey, scriptPath, AdvUseCtrl, AdvUseShift, AdvUseAlt, AdvUseWin, AdvWinCondition)
        } else if (AdvHotkeyScript != "") {
            AddNoFlxHotkey(AdvHotkeyKey, AdvHotkeyScript, AdvUseCtrl, AdvUseShift, AdvUseAlt, AdvUseWin, AdvWinCondition)
        } else {
            MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø³ÙƒØ±Ø¨Øª Ø£Ùˆ Ø§Ø®ØªÙŠØ§Ø± ÙˆØ§Ø­Ø¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.
            return
        }
        if (NoFlxHotkeys.Count() > oldHotkeyCount || NoFlxHotkeys.HasKey(fullKey)) {
            GuiControl, CustomHotkeys:, AdvHotkeyKey,
            GuiControl, CustomHotkeys:, AdvHotkeyScript,
            GuiControl, CustomHotkeys:, AdvWinCondition,
            GuiControl, CustomHotkeys:, AdvUseFlx, 1
            GuiControl, CustomHotkeys:, AdvUseCtrl, 0
            GuiControl, CustomHotkeys:, AdvUseShift, 0
            GuiControl, CustomHotkeys:, AdvUseAlt, 0
            GuiControl, CustomHotkeys:, AdvUseWin, 0
            GuiControl, CustomHotkeys:, SelectedScript, % "|" GetScriptList()
            MsgBox, 64, ØªÙ…, ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx Ø¨Ù†Ø¬Ø§Ø­!
        } else {
            MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx.
        }
    }
return

BrowseAdvAction:
    Gui, CustomHotkeys:Submit, NoHide
    FileSelectFile, selectedFile, 3, , Ø§Ø®ØªØ± Ù…Ù„Ù Ø³ÙƒØ±Ø¨Øª AHK, AutoHotkey Scripts (*.ahk)
    if (selectedFile != "") {
        FileRead, scriptContent, %selectedFile%
        GuiControl, CustomHotkeys:, AdvHotkeyScript, %scriptContent%
    }
return

OpenHotkeyManagerGUI:
    global CustomHotkeys, AdvancedScripts, NoFlxHotkeys, scriptsDir
    Gui, HotkeyManager:Destroy
    Gui, HotkeyManager:Color, 2D2D2D
    Gui, HotkeyManager:Font, cFFFFFF s10, Segoe UI
    Gui, HotkeyManager:Add, Text, x20 y20 w540 h25, Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª:
    Gui, HotkeyManager:Add, Edit, x20 y50 w440 h25 vSearchTerm gSearchHotkeys c000000 Background424242,
    Gui, HotkeyManager:Add, Button, x470 y50 w90 h25 gSearchHotkeys, Ø¨Ø­Ø«
    Gui, HotkeyManager:Add, ListView, x20 y80 w540 h200 vHotkeyList gHotkeyListEvent -Multi +Grid +LV0x10000 Background2D2D2D, Ø§Ù„Ù…ÙØªØ§Ø­|Ø§Ù„Ù†Ø§ÙØ°Ø©|Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡|Ø§Ù„Ù†ÙˆØ¹
    Gui, HotkeyManager:Add, Button, x20 y290 w150 h30 gManageUnusedScripts, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
    Gui, HotkeyManager:Add, Button, x180 y290 w100 h30 gDeleteSelectedHotkeys, Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯
    Gui, HotkeyManager:Add, Button, x300 y290 w100 h30 gEditSelectedHotkey, ØªØ¹Ø¯ÙŠÙ„
    Gui, HotkeyManager:Add, Button, x420 y290 w100 h30 gCancelHotkeyManager, Ø¥Ù„ØºØ§Ø¡
    for fullKey, action in CustomHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        LV_Add("", key, winCondition, action, "Ø¨Ø³ÙŠØ· (Flx)")
    }
    for fullKey, script in AdvancedScripts {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        fullPath := (InStr(script, "\") = 1 || InStr(script, ":") = 2) ? script : scriptsDir "\" script
        displayScript := FileExist(fullPath) ? script : script . " (ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯)"
        LV_Add("", key, winCondition, displayScript, "Ù…ØªÙ‚Ø¯Ù… (Flx)")
    }
    for fullKey, action in NoFlxHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        if (RegExMatch(action, "\.ahk$")) {
            fullPath := (InStr(action, "\") = 1 || InStr(action, ":") = 2) ? action : scriptsDir "\" action
            displayAction := FileExist(fullPath) ? action : action . " (ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯)"
        } else {
            displayAction := action
        }
        LV_Add("", key, winCondition, displayAction, "Ø¨Ø³ÙŠØ· (NoFlx)")
    }
    LV_ModifyCol(1, 50)
    LV_ModifyCol(2, 100)
    LV_ModifyCol(3, 340)
    LV_ModifyCol(4, 50)
    Gui, HotkeyManager:Show, w650 h330, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª
return

ManageUnusedScripts:
    global AdvancedScripts, scriptsDir
    Gui, UnusedScripts:Destroy
    Gui, UnusedScripts:Color, 2D2D2D
    Gui, UnusedScripts:Font, cFFFFFF s10, Segoe UI
    Gui, UnusedScripts:Add, Text, x20 y20 w540 h25, Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø© ÙÙŠ Ø£ÙŠ Ø§Ø®ØªØµØ§Ø±:
    Gui, UnusedScripts:Add, ListBox, x20 y50 w540 h200 vUnusedScriptList c000000 Background424242, % GetUnusedScriptList()
    Gui, UnusedScripts:Add, Button, x180 y260 w100 h30 gDeleteSelectedUnusedScript, Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø¯Ø¯
    Gui, UnusedScripts:Add, Button, x300 y260 w100 h30 gCancelUnusedScripts, Ø¥Ù„ØºØ§Ø¡
    Gui, UnusedScripts:Show, w600 h300, Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª ØºÙŠØ± Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…Ø©
return

GetUnusedScriptList() {
    global AdvancedScripts, scriptsDir
    usedScripts := {}
    scriptList := ""
    for fullKey, scriptPath in AdvancedScripts {
        usedScripts[scriptPath] := true
    }
    Loop, Files, %scriptsDir%\*.ahk
    {
        scriptPath := "Scripts\" A_LoopFileName
        SplitPath, A_LoopFileName,,,, scriptName
        if (!usedScripts.HasKey(scriptPath)) {
            scriptList .= scriptName "|"
        }
    }
    return RTrim(scriptList, "|")
}

DeleteSelectedUnusedScript:
    Gui, UnusedScripts:Submit, NoHide
    if (UnusedScriptList = "") {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø³ÙƒØ±Ø¨Øª Ù„Ø­Ø°ÙÙ‡.
        return
    }
    fullPath := scriptsDir "\" UnusedScriptList ".ahk"
    MsgBox, 4, ØªØ£ÙƒÙŠØ¯, Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª "%UnusedScriptList%"ØŸ
    IfMsgBox, Yes
    {
        FileDelete, %fullPath%
        if (ErrorLevel) {
            MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø­Ø°Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª: %fullPath%
        } else {
            GuiControl, UnusedScripts:, UnusedScriptList, % GetUnusedScriptList()
            MsgBox, 64, ØªÙ…, ØªÙ… Ø­Ø°Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø¨Ù†Ø¬Ø§Ø­!
        }
    }
return

CancelUnusedScripts:
    Gui, UnusedScripts:Destroy
return

CancelHotkeyManager:
    Gui, HotkeyManager:Destroy
return

SearchHotkeys:
    Gui, HotkeyManager:Submit, NoHide
    LV_Delete()
    for fullKey, action in CustomHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        if (SearchTerm = "" || InStr(key, SearchTerm) || InStr(winCondition, SearchTerm) || InStr(action, SearchTerm)) {
            LV_Add("", key, winCondition, action, "Ø¨Ø³ÙŠØ· (Flx)")
        }
    }
    for fullKey, script in AdvancedScripts {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        if (SearchTerm = "" || InStr(key, SearchTerm) || InStr(winCondition, SearchTerm) || InStr(script, SearchTerm)) {
            LV_Add("", key, winCondition, script, "Ù…ØªÙ‚Ø¯Ù… (Flx)")
        }
    }
    for fullKey, action in NoFlxHotkeys {
        SplitKeyCond := StrSplit(fullKey, "|")
        key := StrReplace(SplitKeyCond[1], "VKBA", ";")
        winCondition := SplitKeyCond.Length() > 1 ? SplitKeyCond[2] : "ØºÙŠØ± Ù…Ø­Ø¯Ø¯"
        if (SearchTerm = "" || InStr(key, SearchTerm) || InStr(winCondition, SearchTerm) || InStr(action, SearchTerm)) {
            LV_Add("", key, winCondition, action, "Ø¨Ø³ÙŠØ· (NoFlx)")
        }
    }
    LV_ModifyCol(1, 50)
    LV_ModifyCol(2, 100)
    LV_ModifyCol(3, 340)
    LV_ModifyCol(4, 50)
return

HotkeyListEvent:
    if (A_GuiEvent = "DoubleClick") {
        row := LV_GetNext(0)
        if (row) {
            LV_GetText(selectedKey, row, 1)
            LV_GetText(selectedWinCondition, row, 2)
            LV_GetText(type, row, 4)
            fullSelectedKey := StrReplace(selectedKey, ";", "VKBA") . (selectedWinCondition != "ØºÙŠØ± Ù…Ø­Ø¯Ø¯" ? "|" . selectedWinCondition : "")
            Gosub, EditSelectedHotkey
        }
    }
return

EditSelectedHotkey:
    row := LV_GetNext(0)
    if (!row) {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø§Ø®ØªØµØ§Ø± Ù„ØªØ¹Ø¯ÙŠÙ„Ù‡.
        return
    }
    LV_GetText(selectedKey, row, 1)
    LV_GetText(selectedWinCondition, row, 2)
    LV_GetText(actionOrScript, row, 3)
    LV_GetText(type, row, 4)
    fullSelectedKey := StrReplace(selectedKey, ";", "VKBA") . (selectedWinCondition != "ØºÙŠØ± Ù…Ø­Ø¯Ø¯" ? "|" . selectedWinCondition : "")
    baseKey := RegExReplace(selectedKey, "[+^!#]")
    Gui, EditHotkey:Destroy
    Gui, EditHotkey:Color, 2D2D2D
    Gui, EditHotkey:Font, cFFFFFF s10, Segoe UI
    Gui, EditHotkey:Add, Text, x20 y20 w150 h25, Ø§Ù„Ù…ÙØªØ§Ø­:
    Gui, EditHotkey:Add, Edit, x180 y20 w150 h25 vNewKey c000000 Background424242, %baseKey%
    Gui, EditHotkey:Add, CheckBox, x20 y50 w60 h25 vUseFlx Checked, Flx
    Gui, EditHotkey:Add, CheckBox, x90 y50 w60 h25 vUseCtrl, Ctrl
    Gui, EditHotkey:Add, CheckBox, x160 y50 w60 h25 vUseShift, Shift
    Gui, EditHotkey:Add, CheckBox, x230 y50 w60 h25 vUseAlt, Alt
    Gui, EditHotkey:Add, CheckBox, x300 y50 w60 h25 vUseWin, Win
    Gui, EditHotkey:Add, Text, x20 y80 w150 h25, Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†Ø´Ø·Ø© (Ø§Ø®ØªÙŠØ§Ø±ÙŠ):
    Gui, EditHotkey:Add, Edit, x180 y80 w300 h25 vNewWinCondition c000000 Background424242, % (selectedWinCondition != "ØºÙŠØ± Ù…Ø­Ø¯Ø¯" ? selectedWinCondition : "")
    Gui, EditHotkey:Add, Button, x490 y80 w80 h25 gBrowseWinConditionEdit, ØªØµÙØ­
    if (InStr(type, "Ø¨Ø³ÙŠØ·")) {
        Gui, EditHotkey:Add, Text, x20 y110 w150 h25, Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡:
        Gui, EditHotkey:Add, Edit, x180 y110 w300 h25 vNewAction c000000 Background424242, %actionOrScript%
    } else {
        Gui, EditHotkey:Add, Text, x20 y110 w150 h25, Ø§Ù„Ø³ÙƒØ±Ø¨Øª:
        Gui, EditHotkey:Add, Edit, x180 y110 w300 h100 vNewAction c000000 Background424242 Multi, %actionOrScript%
        fullPath := A_ScriptDir "\" actionOrScript
        if FileExist(fullPath) {
            FileRead, scriptContent, %fullPath%
            GuiControl, EditHotkey:, NewAction, %scriptContent%
        }
        Gui, EditHotkey:Add, Text, x20 y220 w150 h25, Ø§Ø®ØªØ± Ø³ÙƒØ±Ø¨Øª Ù…ÙˆØ¬ÙˆØ¯:
        Gui, EditHotkey:Add, DropDownList, x180 y220 w300 h25 R10 vSelectedScript c000000 Background424242 gLoadSelectedScriptEdit, % GetScriptList()
        Gui, EditHotkey:Add, Button, x490 y220 w80 h25 gLoadSelectedScriptEdit, ØªØ­Ù…ÙŠÙ„
    }
    Gui, EditHotkey:Add, Button, x180 y260 w100 h30 gSaveEditedHotkey, Ø­ÙØ¸
    Gui, EditHotkey:Add, Button, x290 y260 w100 h30 gCancelEditHotkey, Ø¥Ù„ØºØ§Ø¡
    Gui, EditHotkey:Add, Button, x400 y260 w100 h30 gDeleteFromEditHotkey, Ø­Ø°Ù
    if (InStr(type, "Ù…ØªÙ‚Ø¯Ù…")) {
        Gui, EditHotkey:Add, Button, x180 y300 w100 h30 gOpenScriptLocation, ÙØªØ­ Ø§Ù„Ù…ÙˆÙ‚Ø¹
    }
    ; ØªØ¹ÙŠÙŠÙ† Ø­Ø§Ù„Ø© Ù…ÙØ§ØªÙŠØ­ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
    if (InStr(fullSelectedKey, "^"))
        GuiControl, EditHotkey:, UseCtrl, 1
    if (InStr(fullSelectedKey, "+"))
        GuiControl, EditHotkey:, UseShift, 1
    if (InStr(fullSelectedKey, "!"))
        GuiControl, EditHotkey:, UseAlt, 1
    if (InStr(fullSelectedKey, "#"))
        GuiControl, EditHotkey:, UseWin, 1
    if (InStr(type, "NoFlx"))
        GuiControl, EditHotkey:, UseFlx, 0
    else
        GuiControl, EditHotkey:, UseFlx, 1
    Gui, EditHotkey:Show, w600 h340, ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø±
return

LoadSelectedScriptEdit:
    Gui, EditHotkey:Submit, NoHide
    if (SelectedScript != "") {
        fullPath := scriptsDir "\" SelectedScript ".ahk"
        if FileExist(fullPath) {
            FileRead, scriptContent, %fullPath%
            GuiControl, EditHotkey:, NewAction, %scriptContent%  ; Ø¹Ø±Ø¶ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ù„Ù„ØªØ­Ù‚Ù‚ ÙÙ‚Ø·
        } else {
            MsgBox, 48, Ø®Ø·Ø£, Ø§Ù„Ø³ÙƒØ±Ø¨Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullPath%
        }
    }
return

BrowseWinConditionEdit:
    ; ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„Ù‚ÙŠÙ…Ø©
    Gui, EditHotkey:Submit, NoHide
    
    ; Ù…ØªØºÙŠØ±Ø§Øª Ù„ØªØªØ¨Ø¹ Ø­Ø§Ù„Ø© Ø§Ù„Ù†ÙˆØ§ÙØ° (true Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø©ØŒ false Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ†)
    EditHotkeyVisible := false
    CustomHotkeysVisible := false
    HotkeyManagerVisible := false
    
    ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…ÙØªÙˆØ­Ø© Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù…Ø¹Ø±ÙØ§Øª Ø¯Ù‚ÙŠÙ‚Ø©
    Gui, EditHotkey:+LastFound
    if (WinExist("ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø± ahk_id " WinExist()))
        EditHotkeyVisible := true
    
    Gui, CustomHotkeys:+LastFound
    if (WinExist("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª ahk_id " WinExist()))
        CustomHotkeysVisible := true
    
    Gui, HotkeyManager:+LastFound
    if (WinExist("Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª ahk_id " WinExist()))
        HotkeyManagerVisible := true
    
    ; Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„Ù…Ø¹Ù†ÙŠØ© Ù…Ø¤Ù‚ØªÙ‹Ø§
    Gui, EditHotkey:Hide
    Gui, CustomHotkeys:Hide
    Gui, HotkeyManager:Hide

    MsgBox, 64, ØªØ¹Ù„ÙŠÙ…Ø§Øª, Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ø§Ø®ØªÙŠØ§Ø±Ù‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ù…ÙˆØ§ÙÙ‚". Ø³ÙŠØªÙ… Ø¥Ø®ÙØ§Ø¡ ÙˆØ§Ø¬Ù‡Ø§Øª Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù…Ø¤Ù‚ØªÙ‹Ø§ Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ø§Ø®ØªÙŠØ§Ø±.
    KeyWait, LButton, D T10
    if (ErrorLevel) {
        MsgBox, 48, Ø®Ø·Ø£, Ù„Ù… ÙŠØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£ÙŠ Ù†Ø§ÙØ°Ø© Ø®Ù„Ø§Ù„ 10 Ø«ÙˆØ§Ù†Ù.
        ; Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„ØªÙŠ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø© ÙÙ‚Ø·
        if (CustomHotkeysVisible)
            Gui, CustomHotkeys:Show
        if (HotkeyManagerVisible)
            Gui, HotkeyManager:Show
        if (EditHotkeyVisible)
            Gui, EditHotkey:Show
        return
    }
    
    ; Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„ØªÙŠ ØªÙ… Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„ÙŠÙ‡Ø§
    MouseGetPos,,, windowID
    WinGet, activeExe, ProcessName, ahk_id %windowID%
    if (activeExe) {
        condition := "ahk_exe " . activeExe
        GuiControl, EditHotkey:, NewWinCondition, %condition%
    } else {
        MsgBox, 48, Ø®Ø·Ø£, Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¹Ù…Ù„ÙŠØ© Ù…Ø±ØªØ¨Ø·Ø© Ø¨Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø©.
    }
    
    ; Ø¥Ø¹Ø§Ø¯Ø© Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù†ÙˆØ§ÙØ° Ø§Ù„ØªÙŠ ÙƒØ§Ù†Øª Ù…ÙØªÙˆØ­Ø© ÙÙ‚Ø·
    if (CustomHotkeysVisible)
        Gui, CustomHotkeys:Show
    if (HotkeyManagerVisible)
        Gui, HotkeyManager:Show
    if (EditHotkeyVisible)
        Gui, EditHotkey:Show
return

OpenScriptLocation:
    global AdvancedScripts, fullSelectedKey
    scriptPath := AdvancedScripts[fullSelectedKey]
    if (scriptPath != "") {
        fullPath := A_ScriptDir "\" scriptPath
        SplitPath, fullPath,, dir
        Run, explorer.exe "%dir%"
    } else {
        MsgBox, 48, Ø®Ø·Ø£, Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø³ÙƒØ±Ø¨Øª.
    }
return

SaveEditedHotkey:
    Gui, EditHotkey:Submit
    if (NewKey = "") {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…ÙØªØ§Ø­.
        Gui, EditHotkey:Destroy
        return
    }
    newKey := StrReplace(NewKey, ";", "VKBA")
    modifierPrefix := (UseFlx ? "" : "") . (UseCtrl ? "^" : "") . (UseShift ? "+" : "") . (UseAlt ? "!" : "") . (UseWin ? "#" : "")
    fullNewKey := modifierPrefix . newKey . (NewWinCondition ? "|" . NewWinCondition : "")
    if (fullNewKey != fullSelectedKey) {
        if (UseFlx && (CustomHotkeys.HasKey(fullNewKey) || AdvancedScripts.HasKey(fullNewKey))) {
            oldAction := CustomHotkeys[fullNewKey] ? CustomHotkeys[fullNewKey] : AdvancedScripts[fullNewKey]
            MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %fullNewKey% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
            IfMsgBox, No
                return
        } else if (!UseFlx && NoFlxHotkeys.HasKey(fullNewKey)) {
            oldAction := NoFlxHotkeys[fullNewKey]
            MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %fullNewKey% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
            IfMsgBox, No
                return
        }
    }
    if (InStr(type, "Flx")) {
        if (InStr(type, "Ø¨Ø³ÙŠØ·")) {
            DeleteHotkeyAction(fullSelectedKey)
            if (UseFlx) {
                AddHotkey(newKey, NewAction, UseCtrl, UseShift, UseAlt, UseWin, UseFlx, NewWinCondition)
            } else {
                AddNoFlxHotkey(newKey, NewAction, UseCtrl, UseShift, UseAlt, UseWin, NewWinCondition)
            }
        } else {
            DeleteAdvancedScript(fullSelectedKey)
            if (UseFlx) {
                if (SelectedScript != "") {
                    ; Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†Ø³Ø¯Ù„Ø©
                    scriptPath := "Scripts\" SelectedScript ".ahk"
                    fullScriptPath := scriptsDir "\" SelectedScript ".ahk"
                    if (!FileExist(fullScriptPath)) {
                        MsgBox, 48, Ø®Ø·Ø£, Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…Ø®ØªØ§Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullScriptPath%
                        return
                    }
                    IniWrite, %scriptPath%, %iniFile%, AdvancedScripts, %fullNewKey%
                    AdvancedScripts[fullNewKey] := scriptPath
                    baseKey := RegExReplace(newKey, "[+^!#]")
                    try {
                        Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
                    } catch e {
                        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
                        return
                    }
                } else if (NewAction != "") {
                    ; Ø¥Ø¯Ø®Ø§Ù„ Ø³ÙƒØ±Ø¨Øª ÙŠØ¯ÙˆÙŠÙ‹Ø§
                    defaultScriptName := newKey
                    InputBox, scriptName, Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª, Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ù‹Ø§ Ù„Ù„Ø³ÙƒØ±Ø¨Øª (Ø¨Ø¯ÙˆÙ† .ahk):,, 300, 150,,,, %defaultScriptName%
                    if (ErrorLevel || scriptName = "") {
                        return
                    }
                    if (SubStr(scriptName, -3) != ".ahk") {
                        scriptName .= ".ahk"
                    }
                    scriptPath := "Scripts\" scriptName
                    fullScriptPath := scriptsDir "\" scriptName
                    for existingKey, existingPath in AdvancedScripts {
                        if (existingPath = scriptPath && existingKey != fullNewKey) {
                            MsgBox, 48, Ø®Ø·Ø£, Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª %scriptName% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ø§Ø®ØªØµØ§Ø± Ø¢Ø®Ø±.`nÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ù…Ø®ØªÙ„Ù.
                            return
                        }
                    }
                    FileDelete, %fullScriptPath%
                    FileAppend, %NewAction%, %fullScriptPath%, UTF-8
                    if (ErrorLevel) {
                        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙÙŠ: %fullScriptPath%
                        return
                    }
                    IniWrite, %scriptPath%, %iniFile%, AdvancedScripts, %fullNewKey%
                    AdvancedScripts[fullNewKey] := scriptPath
                    baseKey := RegExReplace(newKey, "[+^!#]")
                    try {
                        Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
                    } catch e {
                        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
                        return
                    }
                } else {
                    MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø³ÙƒØ±Ø¨Øª Ø£Ùˆ Ø§Ø®ØªÙŠØ§Ø± ÙˆØ§Ø­Ø¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.
                    return
                }
            } else {
                AddNoFlxHotkey(newKey, NewAction, UseCtrl, UseShift, UseAlt, UseWin, NewWinCondition)
            }
        }
    } else {
        DeleteNoFlxHotkey(fullSelectedKey)
        if (UseFlx) {
            if (InStr(type, "Ø¨Ø³ÙŠØ·")) {
                AddHotkey(newKey, NewAction, UseCtrl, UseShift, UseAlt, UseWin, UseFlx, NewWinCondition)
            } else {
                if (SelectedScript != "") {
                    scriptPath := "Scripts\" SelectedScript ".ahk"
                    fullScriptPath := scriptsDir "\" SelectedScript ".ahk"
                    if (!FileExist(fullScriptPath)) {
                        MsgBox, 48, Ø®Ø·Ø£, Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…Ø®ØªØ§Ø± ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullScriptPath%
                        return
                    }
                    IniWrite, %scriptPath%, %iniFile%, AdvancedScripts, %fullNewKey%
                    AdvancedScripts[fullNewKey] := scriptPath
                    baseKey := RegExReplace(newKey, "[+^!#]")
                    try {
                        Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
                    } catch e {
                        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
                        return
                    }
                } else if (NewAction != "") {
                    defaultScriptName := newKey
                    InputBox, scriptName, Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª, Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ù‹Ø§ Ù„Ù„Ø³ÙƒØ±Ø¨Øª (Ø¨Ø¯ÙˆÙ† .ahk):,, 300, 150,,,, %defaultScriptName%
                    if (ErrorLevel || scriptName = "") {
                        return
                    }
                    if (SubStr(scriptName, -3) != ".ahk") {
                        scriptName .= ".ahk"
                    }
                    scriptPath := "Scripts\" scriptName
                    fullScriptPath := scriptsDir "\" scriptName
                    for existingKey, existingPath in AdvancedScripts {
                        if (existingPath = scriptPath && existingKey != fullNewKey) {
                            MsgBox, 48, Ø®Ø·Ø£, Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª %scriptName% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ø§Ø®ØªØµØ§Ø± Ø¢Ø®Ø±.`nÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ù…Ø®ØªÙ„Ù.
                            return
                        }
                    }
                    FileDelete, %fullScriptPath%
                    FileAppend, %NewAction%, %fullScriptPath%, UTF-8
                    if (ErrorLevel) {
                        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙÙŠ: %fullScriptPath%
                        return
                    }
                    IniWrite, %scriptPath%, %iniFile%, AdvancedScripts, %fullNewKey%
                    AdvancedScripts[fullNewKey] := scriptPath
                    baseKey := RegExReplace(newKey, "[+^!#]")
                    try {
                        Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
                    } catch e {
                        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
                        return
                    }
                } else {
                    MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø³ÙƒØ±Ø¨Øª Ø£Ùˆ Ø§Ø®ØªÙŠØ§Ø± ÙˆØ§Ø­Ø¯ Ù…Ù† Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©.
                    return
                }
            }
        } else {
            AddNoFlxHotkey(newKey, NewAction, UseCtrl, UseShift, UseAlt, UseWin, NewWinCondition)
        }
    }
    Gui, EditHotkey:Destroy
    Gosub, OpenHotkeyManagerGUI
    MsgBox, 64, ØªÙ…, ØªÙ… ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ù†Ø¬Ø§Ø­!
return

CancelEditHotkey:
    Gui, EditHotkey:Destroy
return

DeleteFromEditHotkey:
    MsgBox, 4, ØªØ£ÙƒÙŠØ¯, Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ø§Ù„Ø§Ø®ØªØµØ§Ø± "%selectedKey%" Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© "%selectedWinCondition%"ØŸ
    IfMsgBox, Yes
    {
        ; Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù†ÙØ³ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© ÙÙŠ DeleteSelectedHotkeys Ù„Ù„ØªÙØ±ÙŠÙ‚ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù†ÙˆØ§Ø¹
        if (InStr(type, "NoFlx"))
        {
            DeleteNoFlxHotkey(fullSelectedKey)
        }
        else if (InStr(type, "Ø¨Ø³ÙŠØ·"))
        {
            DeleteHotkeyAction(fullSelectedKey)
        }
        else if (InStr(type, "Ù…ØªÙ‚Ø¯Ù…"))
        {
            DeleteAdvancedScript(fullSelectedKey)
        }
        Gui, EditHotkey:Destroy
        Gosub, OpenHotkeyManagerGUI
        MsgBox, 64, ØªÙ…, ØªÙ… Ø­Ø°Ù Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ù†Ø¬Ø§Ø­!
    }
return

DeleteSelectedHotkeys:
    selectedRows := []
    Loop {
        row := LV_GetNext(row ? row : 0)
        if (!row)
            break
        LV_GetText(key, row, 1)
        LV_GetText(winCondition, row, 2)
        LV_GetText(type, row, 4)
        fullKey := StrReplace(key, ";", "VKBA") . (winCondition != "ØºÙŠØ± Ù…Ø­Ø¯Ø¯" ? "|" . winCondition : "")
        selectedRows.Push({Key: fullKey, Type: type})
    }
    count := selectedRows.Length()
    if (count = 0) {
        MsgBox, 48, Ø®Ø·Ø£, ÙŠØ±Ø¬Ù‰ ØªØ­Ø¯ÙŠØ¯ Ø§Ø®ØªØµØ§Ø± ÙˆØ§Ø­Ø¯ Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„.
        return
    }
    MsgBox, 4, ØªØ£ÙƒÙŠØ¯, Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù %count% Ø¹Ù†Ø§ØµØ± Ù…Ø­Ø¯Ø¯Ø©ØŸ
    IfMsgBox, Yes
    {
        for index, item in selectedRows {
            if (InStr(item.Type, "NoFlx")) {
                DeleteNoFlxHotkey(item.Key)
            } else if (InStr(item.Type, "Ø¨Ø³ÙŠØ·")) {
                DeleteHotkeyAction(item.Key)
            } else if (InStr(item.Type, "Ù…ØªÙ‚Ø¯Ù…")) {
                DeleteAdvancedScript(item.Key)
            }
        }
        Gosub, OpenHotkeyManagerGUI
        MsgBox, 64, ØªÙ…, ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­!
    }
return

DeleteHotkeyAction(fullKey) {
    global iniFile, CustomHotkeys, baseHotkey
    IniDelete, %iniFile%, CustomHotkeys, %fullKey%
    CustomHotkeys.Delete(fullKey)
    SplitKeyCond := StrSplit(fullKey, "|")
    key := SplitKeyCond[1]
    baseKey := RegExReplace(key, "[+^!#]")
    try {
        Hotkey, % baseHotkey " & " . baseKey, Off
    } catch e {
        ; ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ù…Ø¹Ø±ÙÙ‹Ø§
    }
}

DeleteAdvancedScript(fullKey) {
    global iniFile, AdvancedScripts, baseHotkey
    IniDelete, %iniFile%, AdvancedScripts, %fullKey%
    AdvancedScripts.Delete(fullKey)
    SplitKeyCond := StrSplit(fullKey, "|")
    key := SplitKeyCond[1]
    baseKey := RegExReplace(key, "[+^!#]")
    try {
        Hotkey, % baseHotkey " & " . baseKey, Off
    } catch e {
        ; ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡
    }
}

DeleteNoFlxHotkey(fullKey) {
    global iniFile, NoFlxHotkeys, HotkeyConditions
    IniDelete, %iniFile%, NoFlx, %fullKey%
    SplitKeyCond := StrSplit(fullKey, "|")
    key := SplitKeyCond[1]
    NoFlxHotkeys.Delete(fullKey)
    if (HotkeyConditions.HasKey(key)) {
        HotkeyConditions[key].Delete(fullKey)
        if (HotkeyConditions[key].Count() = 0) {
            HotkeyConditions.Delete(key)
            try {
                Hotkey, %key%, Off
            } catch e {
                ; ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ù…Ø¹Ø±ÙÙ‹Ø§
            }
        }
    }
}

AddHotkey(key, action, useCtrl := 0, useShift := 0, useAlt := 0, useWin := 0, useFlx := 1, winCondition := "") {
    global iniFile, CustomHotkeys, baseHotkey
    if (key = ";") {
        key := "VKBA"
    } else {
        key := Format("{:U}", key)
    }
    modifierPrefix := (useCtrl ? "^" : "") . (useShift ? "+" : "") . (useAlt ? "!" : "") . (useWin ? "#" : "")
    fullKey := modifierPrefix . key . (winCondition ? "|" . winCondition : "")
    if (CustomHotkeys.HasKey(fullKey)) {
        oldAction := CustomHotkeys[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %winCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
        DeleteHotkeyAction(fullKey)
    } else if (AdvancedScripts.HasKey(fullKey)) {
        oldScript := AdvancedScripts[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %winCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ ÙƒØ³ÙƒØ±Ø¨Øª Ù…ØªÙ‚Ø¯Ù…:`n%oldScript%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
        DeleteAdvancedScript(fullKey)
    }
    IniWrite, %action%, %iniFile%, CustomHotkeys, %fullKey%
    CustomHotkeys[fullKey] := action
    baseKey := RegExReplace(key, "[+^!#]")
    try {
        Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
    } catch e {
        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø±: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
    }
}

AddAdvancedScript(key, script, useCtrl := 0, useShift := 0, useAlt := 0, useWin := 0, defaultName := "", winCondition := "") {
    global iniFile, AdvancedScripts, scriptsDir, baseHotkey
    if (key = ";") {
        key := "VKBA"
    } else {
        key := Format("{:U}", key)
    }
    modifierPrefix := (useCtrl ? "^" : "") . (useShift ? "+" : "") . (useAlt ? "!" : "") . (useWin ? "#" : "")
    fullKey := modifierPrefix . key . (winCondition ? "|" . winCondition : "")
    defaultValue := defaultName ? defaultName : key
    InputBox, scriptName, Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª, Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ù‹Ø§ Ù„Ù„Ø³ÙƒØ±Ø¨Øª (Ø¨Ø¯ÙˆÙ† .ahk):,, 300, 150,,,, %defaultValue%
    if (ErrorLevel || scriptName = "") {
        return 0
    }
    if (SubStr(scriptName, -3) != ".ahk") {
        scriptName .= ".ahk"
    }
    scriptPath := "Scripts\" scriptName
    fullScriptPath := scriptsDir "\" scriptName
    for existingKey, existingPath in AdvancedScripts {
        if (existingPath = scriptPath && existingKey != fullKey) {
            MsgBox, 48, Ø®Ø·Ø£, Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª %scriptName% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ø§Ø®ØªØµØ§Ø± Ø¢Ø®Ø±.`nÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ù…Ø®ØªÙ„Ù.
            return 0
        }
    }
    FileDelete, %fullScriptPath%
    FileAppend, %script%, %fullScriptPath%, UTF-8
    if (ErrorLevel) {
        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙÙŠ: %fullScriptPath%
        return 0
    }
    if (AdvancedScripts.HasKey(fullKey)) {
        oldScriptPath := AdvancedScripts[fullKey]
        if (oldScriptPath != scriptPath) {
            FileDelete, % A_ScriptDir "\" oldScriptPath
        }
        IniDelete, %iniFile%, AdvancedScripts, %fullKey%
    }
    IniWrite, %scriptPath%, %iniFile%, AdvancedScripts, %fullKey%
    AdvancedScripts[fullKey] := scriptPath
    baseKey := RegExReplace(key, "[+^!#]")
    try {
        Hotkey, % baseHotkey " & " . baseKey, ExecuteHotkey, On
    } catch e {
        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…: %baseHotkey% & %baseKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
        return 0
    }
    return 1
}

AddNoFlxHotkey(key, action, useCtrl := 0, useShift := 0, useAlt := 0, useWin := 0, winCondition := "") {
    global iniFile, NoFlxHotkeys, HotkeyConditions, scriptsDir
    if (key = ";") {
        key := "VKBA"
    } else {
        key := Format("{:U}", key)
    }
    modifierPrefix := (useCtrl ? "^" : "") . (useShift ? "+" : "") . (useAlt ? "!" : "") . (useWin ? "#" : "")
    fullKey := modifierPrefix . key . (winCondition ? "|" . winCondition : "")
    
    ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù…Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ø³ÙƒØ±Ø¨ØªÙ‹Ø§
    if (InStr(action, "`n") || RegExMatch(action, "\.ahk$")) {
        ; Ø­Ø§Ù„Ø© Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ù‹Ø§ (Ù…Ø³Ø§Ø± Ù…Ù„Ù)
        if (RegExMatch(action, "\.ahk$") && !InStr(action, "`n")) {
            ; ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„
            fullScriptPath := (InStr(action, "\") = 1 || InStr(action, ":") = 2) ? action : scriptsDir "\" action
            if (!FileExist(fullScriptPath)) {
                MsgBox, 48, Ø®Ø·Ø£, Ù…Ù„Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullScriptPath%
                return
            }
            scriptPath := action  ; Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…Ø³Ø§Ø± ÙƒÙ…Ø§ Ù‡Ùˆ
        }
        ; Ø­Ø§Ù„Ø© ÙƒÙˆØ¯ Ø³ÙƒØ±Ø¨Øª ÙŠØ¯ÙˆÙŠ (Ù…ØªØ¹Ø¯Ø¯ Ø§Ù„Ø£Ø³Ø·Ø±)
        else if (InStr(action, "`n")) {
            defaultValue := key
            InputBox, scriptName, Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª, Ø£Ø¯Ø®Ù„ Ø§Ø³Ù…Ù‹Ø§ Ù„Ù„Ø³ÙƒØ±Ø¨Øª (Ø¨Ø¯ÙˆÙ† .ahk):,, 300, 150,,,, %defaultValue%
            if (ErrorLevel || scriptName = "") {
                return
            }
            if (SubStr(scriptName, -3) != ".ahk") {
                scriptName .= ".ahk"
            }
            scriptPath := "Scripts\" scriptName
            fullScriptPath := scriptsDir "\" scriptName
            
            ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ ØªØ¹Ø§Ø±Ø¶ ÙÙŠ Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª
            for existingKey, existingAction in NoFlxHotkeys {
                if (existingAction = scriptPath && existingKey != fullKey) {
                    MsgBox, 48, Ø®Ø·Ø£, Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª %scriptName% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„ Ù„Ø§Ø®ØªØµØ§Ø± Ø¢Ø®Ø±.`nÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ø³Ù… Ù…Ø®ØªÙ„Ù.
                    return
                }
            }
            
            ; ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø¥Ù„Ù‰ Ù…Ù„Ù
            FileDelete, %fullScriptPath%
            FileAppend, %action%, %fullScriptPath%, UTF-8
            if (ErrorLevel) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ Ø­ÙØ¸ Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙÙŠ: %fullScriptPath%
                return
            }
        }
        
        ; Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù‚Ø¯ÙŠÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ù‹Ø§
        if (NoFlxHotkeys.HasKey(fullKey)) {
            oldAction := NoFlxHotkeys[fullKey]
            if (RegExMatch(oldAction, "\.ahk$") && oldAction != scriptPath) {
                FileDelete, % A_ScriptDir "\" oldAction
            }
            IniDelete, %iniFile%, NoFlx, %fullKey%
        }
        
        action := scriptPath  ; ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡ Ù„ÙŠÙƒÙˆÙ† Ø§Ù„Ù…Ø³Ø§Ø±
    }
    
    ; Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¨Ø³ÙŠØ·Ø© Ø£Ùˆ Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª
    if (NoFlxHotkeys.HasKey(fullKey)) {
        oldAction := NoFlxHotkeys[fullKey]
        MsgBox, 4, ØªØ­Ø°ÙŠØ±, Ø§Ù„Ù…ÙØªØ§Ø­ %key% Ù…Ø¹ Ø´Ø±Ø· Ø§Ù„Ù†Ø§ÙØ°Ø© %winCondition% Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„:`n%oldAction%`nÙ‡Ù„ ØªØ±ÙŠØ¯ Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡ØŸ
        IfMsgBox, No
            return
        DeleteNoFlxHotkey(fullKey)
    }
    
    IniWrite, %action%, %iniFile%, NoFlx, %fullKey%
    NoFlxHotkeys[fullKey] := action
    
    if (!HotkeyConditions.HasKey(modifierPrefix . key)) {
        HotkeyConditions[modifierPrefix . key] := {}
    }
    HotkeyConditions[modifierPrefix . key][fullKey] := winCondition
    
    try {
        if (winCondition) {
            Hotkey, IfWinActive, %winCondition%
            Hotkey, % modifierPrefix . key, ExecuteNoFlxHotkeyConditional, On
            Hotkey, IfWinActive
        } else {
            Hotkey, % modifierPrefix . key, ExecuteNoFlxHotkeyConditional, On
        }
    } catch e {
        MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ¹Ø±ÙŠÙ Ø§Ù„Ø§Ø®ØªØµØ§Ø± Ø¨Ø¯ÙˆÙ† Flx: %fullKey%`nØ§Ù„Ø³Ø¨Ø¨: %e%
    }
}

ExecuteHotkey:
    global CustomHotkeys, AdvancedScripts, baseHotkey, scriptsDir
    keyPressed := StrReplace(A_ThisHotkey, baseHotkey " & ")
    ctrlState := GetKeyState("Ctrl", "P")
    shiftState := GetKeyState("Shift", "P")
    altState := GetKeyState("Alt", "P")
    winState := GetKeyState("LWin", "P") || GetKeyState("RWin", "P")
    modifierPrefix := (ctrlState ? "^" : "") . (shiftState ? "+" : "") . (altState ? "!" : "") . (winState ? "#" : "")
    baseKey := modifierPrefix . keyPressed
    WinGet, activeExe, ProcessName, A
    currentWinCondition := activeExe ? "ahk_exe " . activeExe : ""
    fullKeyWithCondition := baseKey . (currentWinCondition ? "|" . currentWinCondition : "")
    fullKeyDefault := baseKey
    if (AdvancedScripts.HasKey(fullKeyWithCondition)) {
        scriptPath := AdvancedScripts[fullKeyWithCondition]
        fullPath := A_ScriptDir "\" scriptPath
        if FileExist(fullPath) {
            SetWorkingDir, %scriptsDir%
            Run, %A_AhkPath% "%fullPath%", , UseErrorLevel
            SetWorkingDir, %A_ScriptDir%
            if (A_LastError) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª: %fullPath%`nØ®Ø·Ø£: %A_LastError%
            }
        } else {
            MsgBox, 48, Ø®Ø·Ø£, Ù…Ù„Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullPath%
        }
    }
    else if (AdvancedScripts.HasKey(fullKeyDefault)) {
        scriptPath := AdvancedScripts[fullKeyDefault]
        fullPath := A_ScriptDir "\" scriptPath
        if FileExist(fullPath) {
            SetWorkingDir, %scriptsDir%
            Run, %A_AhkPath% "%fullPath%", , UseErrorLevel
            SetWorkingDir, %A_ScriptDir%
            if (A_LastError) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª: %fullPath%`nØ®Ø·Ø£: %A_LastError%
            }
        } else {
            MsgBox, 48, Ø®Ø·Ø£, Ù…Ù„Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯: %fullPath%
        }
    }
    else if (CustomHotkeys.HasKey(fullKeyWithCondition)) {
        action := CustomHotkeys[fullKeyWithCondition]
        ExecuteSingleAction(action)
    }
    else if (CustomHotkeys.HasKey(fullKeyDefault)) {
        action := CustomHotkeys[fullKeyDefault]
        ExecuteSingleAction(action)
    }
return

ExecuteNoFlxHotkey:
    global NoFlxHotkeys
    keyPressed := A_ThisHotkey
    WinGet, activeExe, ProcessName, A
    currentWinCondition := activeExe ? "ahk_exe " . activeExe : ""
    fullKeyWithCondition := keyPressed . (currentWinCondition ? "|" . currentWinCondition : "")
    fullKeyDefault := keyPressed
    if (NoFlxHotkeys.HasKey(fullKeyWithCondition)) {
        action := NoFlxHotkeys[fullKeyWithCondition]
        ExecuteSingleAction(action)
    }
    else if (NoFlxHotkeys.HasKey(fullKeyDefault)) {
        action := NoFlxHotkeys[fullKeyDefault]
        ExecuteSingleAction(action)
    }
return

ExecuteSingleAction(action) {
    action := Trim(action)
    if (InStr(action, "Run ") = 1) {
        command := Trim(SubStr(action, 5))
        SplitPath, command, fileName, dir
        if (fileName = "") {  ; Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…Ø¬Ù„Ø¯Ù‹Ø§
            Run, explorer.exe "%command%", , UseErrorLevel
            if (A_LastError) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ÙØªØ­ Ø§Ù„Ù…Ø¬Ù„Ø¯: %command%`nØ®Ø·Ø£: %A_LastError%
            }
            return
        }

        ; Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„ØªØ·Ø¨ÙŠÙ‚
        fullPath := command

        ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø±ÙƒØ²Ø© ÙÙ‚Ø·
        WinGet, activeFullPath, ProcessPath, A  ; Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù†Ø´Ø·Ø©
        WinGet, activeID, ID, A
        if (activeFullPath = fullPath) {  ; Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø±ÙƒØ²Ø© Ù‡ÙŠ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
            WinMinimize, ahk_id %activeID%
            return
        }

        ; Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù…Ø±ÙƒØ²Ø©
        WinGet, processList, List
        found := false
        targetID := ""
        Loop, %processList% {
            thisID := processList%A_Index%
            WinGet, thisPath, ProcessPath, ahk_id %thisID%
            if (thisPath = fullPath) {  ; Ø¥Ø°Ø§ ØªØ·Ø§Ø¨Ù‚ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„
                found := true
                targetID := thisID
                break  ; Ù†ÙˆÙ‚Ù Ø§Ù„Ø¨Ø­Ø« Ø¨Ù…Ø¬Ø±Ø¯ Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø©
            }
        }

        if (found) {  ; Ø¥Ø°Ø§ ÙˆØ¬Ø¯Ù†Ø§ Ø§Ù„Ù†Ø§ÙØ°Ø© ÙˆÙ„ÙƒÙ†Ù‡Ø§ Ù„ÙŠØ³Øª Ù…Ø±ÙƒØ²Ø©
            WinGet, thisState, MinMax, ahk_id %targetID%
            if (thisState = -1) {  ; Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØµØºØ±Ø©
                WinRestore, ahk_id %targetID%
            }
            WinActivate, ahk_id %targetID%  ; Ù†Ø±ÙƒØ² Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø©
        } else {  ; Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù†Ø§ÙØ°Ø©ØŒ Ù†Ø´ØºÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
            Run, %command%, , UseErrorLevel
            if (A_LastError) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªØ´ØºÙŠÙ„: %command%`nØ®Ø·Ø£: %A_LastError%
            }
        }
    } else if (InStr(action, "Send ") = 1) {
        command := Trim(SubStr(action, 6))
        Send, %command%
    } else if (InStr(action, "WinMinimize") = 1) {
        WinMinimize, A
    } else if (InStr(action, "WinMaximize") = 1) {
        WinMaximize, A
    } else if (InStr(action, "WinClose") = 1) {
        WinClose, A
    } else {
        try {
            Run, %A_AhkPath% /c "%action%", , UseErrorLevel
            if (A_LastError) {
                MsgBox, 48, Ø®Ø·Ø£, ÙØ´Ù„ ØªÙ†ÙÙŠØ° Ø§Ù„Ø£Ù…Ø±: %action%`nØ®Ø·Ø£: %A_LastError%
            }
        } catch e {
            MsgBox, 48, Ø®Ø·Ø£, Ø§Ù„Ø£Ù…Ø± ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… Ø£Ùˆ ØºÙŠØ± ØµØ§Ù„Ø­: %action%`nØ§Ù„Ø³Ø¨Ø¨: %e%
        }
    }
}

;------------------ Additional Hotkeys and Functions ------------------

ToggleSecureMode() {
    global isSecureMode, checkInterval, processNames, iniFile
    isSecureMode := !isSecureMode
    IniWrite, %isSecureMode%, %iniFile%, Settings, IsSecureMode
    if (isSecureMode) {
        WinGet, activeWindow, ID, A
        Gui, SecureModeIndicator:Show, NoActivate
        processList := StrSplit(processNames, ",")
        for index, proc in processList {
            Process, Exist, %proc%
            if (ErrorLevel) {
                Process, Close, %proc%
            }
        }
        SetTimer, CheckSecureMode, %checkInterval%
        WinActivate, ahk_id %activeWindow%
    } else {
        Gui, SecureModeIndicator:Hide
        SetTimer, CheckSecureMode, Off
    }
}

CheckSecureMode:
    global isSecureMode, processNames
    if (isSecureMode) {
        processList := StrSplit(processNames, ",")
        for index, proc in processList {
            Process, Exist, %proc%
            if (ErrorLevel) {
                Process, Close, %proc%
            }
        }
        CloseMonitoredFolders()
    }
return

CloseMonitoredFolders() {
    global monitoredFolders, monitoredFoldersWithSub, excludedFolders
    shell := ComObjCreate("Shell.Application")
    folderList := StrSplit(monitoredFolders, ",")
    folderListWithSub := StrSplit(monitoredFoldersWithSub, ",")
    excludedList := StrSplit(excludedFolders, ",")

    for window in shell.Windows {
        try {
            windowFolder := window.document.Folder.Self.Path
        } catch {
            continue
        }
        currentFolder := Trim(windowFolder, " `t`r`n\\")
        StringLower, currentFolder, currentFolder

        ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªØ«Ù†Ø§Ø©
        for index, excluded in excludedList {
            excluded := Trim(excluded, " `t`r`n\\")
            StringLower, excluded, excluded
            if (InStr(currentFolder, excluded) = 1) {
                continue 2 ; ØªØ®Ø·ÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙÙŠ Ù…Ø¬Ù„Ø¯ Ù…Ø³ØªØ«Ù†Ù‰
            }
        }

        ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ø¨Ø¯ÙˆÙ† ØªÙØ±Ø¹Ø§Øª
        for index, folder in folderList {
            targetFolder := Trim(folder, " `t`r`n\\")
            StringLower, targetFolder, targetFolder
            if (currentFolder = targetFolder) {
                window.Quit()
                Sleep, 100
                break
            }
        }

        ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…Ø¹ ØªÙØ±Ø¹Ø§ØªÙ‡Ø§
        for index, folder in folderListWithSub {
            targetFolder := Trim(folder, " `t`r`n\\")
            StringLower, targetFolder, targetFolder
            if (InStr(currentFolder, targetFolder) = 1) {
                window.Quit()
                Sleep, 100
                break
            }
        }
    }
}

OpenSettings() {
    global monitoredFolders, monitoredFoldersWithSub, processNames, checkInterval
    Gui, GuiSettings:Destroy
    Gui, GuiSettings:Color, 2D2D2D
    Gui, GuiSettings:Font, cFFFFFF s10, Segoe UI
    Gui, GuiSettings:Add, Text, x10 y10 w530 h30 Center cFFD700, Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³ÙƒØ±Ø¨Øª
    Gui, GuiSettings:Add, Text, x10 y50 w200 h25, Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© (Ø¨Ø¯ÙˆÙ† ØªÙØ±Ø¹Ø§Øª):
    Gui, GuiSettings:Add, Edit, x220 y50 w300 h25 vMonFolders c000000 Background424242, %monitoredFolders%
    Gui, GuiSettings:Add, Button, x530 y50 w80 h25 gBrowseFolders, ØªØµÙØ­
    Gui, GuiSettings:Add, Text, x10 y85 w200 h25, Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© (Ù…Ø¹ ØªÙØ±Ø¹Ø§Øª):
    Gui, GuiSettings:Add, Edit, x220 y85 w300 h25 vMonFoldersWithSub c000000 Background424242, %monitoredFoldersWithSub%
    Gui, GuiSettings:Add, Button, x530 y85 w80 h25 gBrowseFoldersWithSub, ØªØµÙØ­
    Gui, GuiSettings:Add, Text, x10 y155 w200 h25, Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© (Ø§ÙØµÙ„ Ø¨ÙÙˆØ§ØµÙ„):
    Gui, GuiSettings:Add, Edit, x220 y155 w300 h25 vProcNames c000000 Background424242, %processNames%
    Gui, GuiSettings:Add, Button, x530 y155 w80 h25'gBrowseProcesses, ØªØµÙØ­
    Gui, GuiSettings:Add, Text, x10 y120 w200 h25, Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª Ø§Ù„Ù…Ø³ØªØ«Ù†Ø§Ø© (Ù…Ø¹ ØªÙØ±Ø¹Ø§Øª):
    Gui, GuiSettings:Add, Edit, x220 y120 w300 h25 vExclFolders c000000 Background424242, %excludedFolders%
    Gui, GuiSettings:Add, Button, x530 y120 w80 h25 gBrowseExcludedFolders, ØªØµÙØ­
    Gui, GuiSettings:Add, Text, x10 y190 w200 h25, ÙØªØ±Ø© Ø§Ù„ÙØ­Øµ (Ø¨Ø§Ù„Ù…Ù„ÙŠ Ø«Ø§Ù†ÙŠØ©):
    Gui, GuiSettings:Add, Edit, x220 y190 w300 h25 vChkInterval c000000 Background424242, %checkInterval%
    Gui, GuiSettings:Add, Button, x260 y235 w100 h30 gSaveSettings, Ø­ÙØ¸
    Gui, GuiSettings:Add, Button, x370 y235 w100 h30 gCancelSettings, Ø¥Ù„ØºØ§Ø¡
    Gui, GuiSettings:Font, cA0A0A0 s8
    Gui, GuiSettings:Add, Text, x10 y275 w620 h20 Center, Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ÙÙˆØ§ØµÙ„ Ù„ÙØµÙ„ Ø§Ù„Ù…Ø¬Ù„Ø¯Ø§Øª ÙˆØ§Ù„Ø¹Ù…Ù„ÙŠØ§ØªØŒ Ø£Ùˆ Ø²Ø± Ø§Ù„ØªØµÙØ­ Ù„Ù„Ø¥Ø¶Ø§ÙØ©
    Gui, GuiSettings:Show, w630 h300, Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø³ÙƒØ±Ø¨Øª
    
}

; ÙˆØ§Ø¬Ù‡Ø© Ù…Ø¤Ø´Ø± ÙˆØ¶Ø¹ Ø§Ù„ØªØ³Ø±ÙŠØ¹
InitSecureModeIndicator() {
    global isSecureMode, checkInterval
    Gui, SecureModeIndicator:New, +LastFound +AlwaysOnTop +ToolWindow -Caption +E0x20
    Gui, SecureModeIndicator:Color, 000000
    WinSet, TransColor, 000000
    Gui, SecureModeIndicator:Font, s12 cFFFFFF, Arial
    Gui, SecureModeIndicator:Add, Text, BackgroundTrans, ÙˆØ¶Ø¹ Ø§Ù„ØªØ³Ø±ÙŠØ¹
    WinSet, Transparent, 150
    ; ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ø¯Ø§Ø¦Ù…Ù‹Ø§
    if (isSecureMode) {
        Gui, SecureModeIndicator:Show, x0 y0 w100 h30 NoActivate
        SetTimer, CheckSecureMode, %checkInterval%
    } else {
        ; ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø¥Ø­Ø¯Ø§Ø«ÙŠØ§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø®ÙØ§Ø¡ Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„ØµØ­ÙŠØ­ Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø¸Ù‡Ø§Ø± Ù„Ø§Ø­Ù‚Ù‹Ø§
        Gui, SecureModeIndicator:Show, x0 y0 w100 h30 NoActivate
        Gui, SecureModeIndicator:Hide
        SetTimer, CheckSecureMode, Off
    }
}


BrowseFolders:
    Gui, GuiSettings:Submit, NoHide
    FileSelectFolder, selectedFolder, , 3, Ø§Ø®ØªØ± Ù…Ø¬Ù„Ø¯Ù‹Ø§ Ù„Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©
    if (selectedFolder != "") {
        if (MonFolders = "")
            GuiControl, GuiSettings:, MonFolders, %selectedFolder%
        else
            GuiControl, GuiSettings:, MonFolders, %MonFolders%,%selectedFolder%
    }
return

BrowseFoldersWithSub:
    Gui, GuiSettings:Submit, NoHide
    FileSelectFolder, selectedFolder, , 3, Ø§Ø®ØªØ± Ù…Ø¬Ù„Ø¯Ù‹Ø§ Ù„Ù„Ù…Ø±Ø§Ù‚Ø¨Ø© Ù…Ø¹ ØªÙØ±Ø¹Ø§ØªÙ‡
    if (selectedFolder != "") {
        if (MonFoldersWithSub = "")
            GuiControl, GuiSettings:, MonFoldersWithSub, %selectedFolder%
        else
            GuiControl, GuiSettings:, MonFoldersWithSub, %MonFoldersWithSub%,%selectedFolder%
    }
return

BrowseExcludedFolders:
    Gui, GuiSettings:Submit, NoHide
    FileSelectFolder, selectedFolder, , 3, Ø§Ø®ØªØ± Ù…Ø¬Ù„Ø¯Ù‹Ø§ Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¦Ù‡
    if (selectedFolder != "") {
        if (ExclFolders = "")
            GuiControl, GuiSettings:, ExclFolders, %selectedFolder%
        else
            GuiControl, GuiSettings:, ExclFolders, %ExclFolders%,%selectedFolder%
    }
return

BrowseProcesses:
    Gui, GuiSettings:Submit, NoHide
    FileSelectFile, selectedFile, 3, , Ø§Ø®ØªØ± Ø¹Ù…Ù„ÙŠØ© Ù„Ù„Ù…Ø±Ø§Ù‚Ø¨Ø©, Executable Files (*.exe)
    if (selectedFile != "") {
        SplitPath, selectedFile, fileName
        if (ProcNames = "")
            GuiControl, GuiSettings:, ProcNames, %fileName%
        else
            GuiControl, GuiSettings:, ProcNames, %ProcNames%,%fileName%
    }
return

SaveSettings:
    global monitoredFolders, monitoredFoldersWithSub, excludedFolders, processNames, checkInterval, iniFile
    Gui, GuiSettings:Submit, NoHide
    monitoredFolders := MonFolders
    monitoredFoldersWithSub := MonFoldersWithSub
    excludedFolders := ExclFolders
    processNames := ProcNames
    if (ChkInterval != "" && RegExMatch(ChkInterval, "^\d+$"))
        checkInterval := ChkInterval
    else {
        MsgBox, 48, ØªØ­Ø°ÙŠØ±, ÙŠØ¬Ø¨ Ø£Ù† ØªÙƒÙˆÙ† ÙØªØ±Ø© Ø§Ù„ÙØ­Øµ Ø¹Ø¯Ø¯Ù‹Ø§ ØµØ­ÙŠØ­Ù‹Ø§.
    }
    IniWrite, %monitoredFolders%, %iniFile%, Settings, MonitoredFolders
    IniWrite, %monitoredFoldersWithSub%, %iniFile%, Settings, MonitoredFoldersWithSub
    IniWrite, %excludedFolders%, %iniFile%, Settings, ExcludedFolders
    IniWrite, %processNames%, %iniFile%, Settings, ProcessNames
    IniWrite, %checkInterval%, %iniFile%, Settings, CheckInterval
    Gui, GuiSettings:Destroy
return

CancelSettings:
    Gui, GuiSettings:Destroy
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\BrightnessDown.ahk ===

brightness := GetBrightness()
newBrightness := brightness - 10
if (newBrightness < 0)
    newBrightness := 0
SetBrightness(newBrightness)
Tooltip, ØªÙ… Ø®ÙØ¶ Ø§Ù„Ø³Ø·ÙˆØ¹ Ø¥Ù„Ù‰ %newBrightness%`
SetTimer, RemoveTooltip, -1000
return

RemoveTooltip:
    Tooltip
return

GetBrightness() {
    objWMIService := ComObjGet("winmgmts:\\.\root\WMI")
    colItems := objWMIService.ExecQuery("Select * from WmiMonitorBrightness")
    for item in colItems
        return item.CurrentBrightness
    return 0
}

SetBrightness(val) {
    objWMIService := ComObjGet("winmgmts:\\.\root\WMI")
    colItems := objWMIService.ExecQuery("Select * from WmiMonitorBrightnessMethods")
    for item in colItems
        item.WmiSetBrightness(1, val)
}

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\BrightnessUp.ahk ===

brightness := GetBrightness()
newBrightness := brightness + 10
if (newBrightness > 100)
    newBrightness := 100
SetBrightness(newBrightness)
Tooltip, ØªÙ… Ø±ÙØ¹ Ø§Ù„Ø³Ø·ÙˆØ¹ Ø¥Ù„Ù‰ %newBrightness%`
SetTimer, RemoveTooltip, -1000
return

RemoveTooltip:
    Tooltip
return

GetBrightness() {
    objWMIService := ComObjGet("winmgmts:\\.\root\WMI")
    colItems := objWMIService.ExecQuery("Select * from WmiMonitorBrightness")
    for item in colItems
        return item.CurrentBrightness
    return 0
}

SetBrightness(val) {
    objWMIService := ComObjGet("winmgmts:\\.\root\WMI")
    colItems := objWMIService.ExecQuery("Select * from WmiMonitorBrightnessMethods")
    for item in colItems
        item.WmiSetBrightness(1, val)
}

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\CopyMove.ahk ===

#SingleInstance Force

; Load settings from INI file
Loop, 12  ; Increased to 12 to include *, /, +
{
    IniRead, Action%A_Index%, %A_ScriptDir%\FileOperations.ini, Settings, Action%A_Index%, Copy
    IniRead, Path%A_Index%, %A_ScriptDir%\FileOperations.ini, Settings, Path%A_Index%, F:\Anime
}

; Define valid keys including new symbols
ValidKeys := "0123456789*/+"
Input, Key, L1 T3, %ValidKeys%
if (ErrorLevel = "Timeout")
    ExitApp

; Exit if key pressed is not in our valid set
if (!InStr(ValidKeys, Key))
    ExitApp

if (Key = "0")
{
    ; Settings GUI with single column, Browse next to Action dropdown
    Gui, Settings:New, +AlwaysOnTop, Button Settings
    Gui, Add, Text, x160 y8, Configure action and path for each button
    
    ; Define button labels including new symbols
    ButtonLabels := ["NumPad1", "NumPad2", "NumPad3", "NumPad4", "NumPad5", "NumPad6", "NumPad7", "NumPad8", "NumPad9", "Multiply(*)", "Divide(/)", "Add(+)"]
    
    Loop, 12  ; Increased to 12 to include *, /, +
    {
        yPos := 30 + (A_Index - 1) * 40
        Gui, Add, Text, x10 y%yPos% w80, % ButtonLabels[A_Index] ":"
        Gui, Add, DropDownList, x90 y%yPos% vAction%A_Index% w100, Copy|Move|Create Shortcut
        GuiControl, ChooseString, Action%A_Index%, % Action%A_Index%
        Gui, Add, Button, x200 y%yPos% gBrowse%A_Index%, Browse
        Gui, Add, Edit, x280 y%yPos% vPath%A_Index% w250, % Path%A_Index%
    }
    
    ; Save and Cancel buttons at the bottom
    Gui, Add, Button, x200 y505 w80 gSaveSettings Default, Save  ; Adjusted Y position
    Gui, Add, Button, x300 y505 w80 gCancelSettings, Cancel     ; Adjusted Y position
    Gui, Show, w550 h540  ; Increased height to accommodate new rows
    return
}

; Map special keys to numbers 10-12
if (Key = "*")
    Num := 10
else if (Key = "/")
    Num := 11
else if (Key = "+")
    Num := 12
else if (Key >= "1" && Key <= "9")
    Num := Key
else
    ExitApp

; Only process if we have a valid number (1-12)
if (Num >= 1 && Num <= 12)
{
    ChosenOperation := Action%Num%
    TargetPath := Path%Num%
    
    ; Copy selected items to clipboard
    Clipboard := ""
    Send {Ctrl down}
    Sleep 100
    Send {c down}
    Sleep 100
    Send {c up}
    Send {Ctrl up}
    ClipWait, 2
    if (ErrorLevel)
        ExitApp

    ; Global variables
    global ApplyToAll := 0
    global ChosenAction := ""
    global CancelCopy := 0
    global TotalBytes := 0
    global ProcessedBytes := 0

    ItemsToCopy := StrSplit(Clipboard, "`n", "`r")

    ; Calculate total size for progress bar
    Loop, % ItemsToCopy.Length()
    {
        Item := Trim(ItemsToCopy[A_Index])
        IfExist, %Item%
        {
            SplitPath, Item,,, ItemExt
            if (ItemExt != "") {
                FileGetSize, FileSize, %Item%
                TotalBytes += FileSize
            }
            else {
                Loop, Files, %Item%\*.*, R
                {
                    FileGetSize, FileSize, %A_LoopFileFullPath%
                    TotalBytes += FileSize
                }
            }
        }
    }

    Progress, B W100 H10 X0 Y0 Range0-%TotalBytes%
    Progress, 0

    ; Process items
    Loop, % ItemsToCopy.Length()
    {
        ItemToCopy := Trim(ItemsToCopy[A_Index])
        
        IfExist, %ItemToCopy%
        {
            SplitPath, ItemToCopy, ItemName,, ItemExt
            
            ; Handle both files and folders
            TargetItem := TargetPath . "\" . ItemName
            IfNotExist, %TargetPath%
                FileCreateDir, %TargetPath%
                
            IfExist, %TargetItem%
            {
                if (ApplyToAll && ChosenAction != "") {
                    if (ChosenAction = "Replace")
                        Gosub, ReplaceAction
                    else if (ChosenAction = "Rename")
                        Gosub, RenameAction
                    else if (ChosenAction = "Cancel")
                        Gosub, SkipAction
                }
                else {
                    ShowDuplicateDialog(ItemName, (ItemExt != "" ? "File" : "Folder"))
                }
            }
            else
                ProcessItem(ItemToCopy, TargetItem)
        }
        if (CancelCopy)
            break
    }

    Progress, Off
    ExitApp
}

; Browse buttons for settings (expanded to 12)
Browse1:
Browse2:
Browse3:
Browse4:
Browse5:
Browse6:
Browse7:
Browse8:
Browse9:
Browse10:
Browse11:
Browse12:
Num := SubStr(A_ThisLabel, 7)
Gui, Settings:Submit, NoHide
FileSelectFolder, SelectedFolder, , 3
if (SelectedFolder != "")
    GuiControl,, Path%Num%, %SelectedFolder%
return

SaveSettings:
Gui, Settings:Submit
Loop, 12  ; Increased to 12
{
    IniWrite, % Action%A_Index%, %A_ScriptDir%\FileOperations.ini, Settings, Action%A_Index%
    IniWrite, % Path%A_Index%, %A_ScriptDir%\FileOperations.ini, Settings, Path%A_Index%
}
Gui, Settings:Destroy
ExitApp

CancelSettings:
Gui, Settings:Destroy
ExitApp

SkipAction:
if (ItemExt != "") {
    FileGetSize, FileSize, %ItemToCopy%
    ProcessedBytes += FileSize
} else {
    Loop, Files, %ItemToCopy%\*.*, R
        FileGetSize, FileSize, %A_LoopFileFullPath%
        ProcessedBytes += FileSize
}
Progress, %ProcessedBytes%
Sleep, 10
return

CancelAction:
Gui, Duplicate:Submit
if (ApplyToAll)
    ChosenAction := "Cancel"
Gui, Duplicate:Destroy
return

CancelAllAction:
global CancelCopy := 1
Gui, Duplicate:Destroy
return

ReplaceAction:
Gui, Duplicate:Submit
if (ApplyToAll)
    ChosenAction := "Replace"
Gui, Duplicate:Destroy
if (ItemExt != "") {
    FileDelete, %TargetItem%
    ProcessItem(ItemToCopy, TargetItem)
} else {
    FileRemoveDir, %TargetItem%, 1
    if (!ErrorLevel)
        ProcessItem(ItemToCopy, TargetItem)
}
return

RenameAction:
Gui, Duplicate:Submit
if (ApplyToAll)
    ChosenAction := "Rename"
Gui, Duplicate:Destroy
Loop
{
    NewName := ItemName . " (" . A_Index . ")"
    if (ItemExt != "")
        NewTarget := TargetPath . "\" . NewName . "." . ItemExt
    else
        NewTarget := TargetPath . "\" . NewName
    
    IfNotExist, %NewTarget%
        break
}
ProcessItem(ItemToCopy, NewTarget)
return

ProcessItem(Source, Dest) {
    global ChosenOperation, ProcessedBytes, ItemExt
    if (ChosenOperation = "Copy") {
        if (ItemExt != "")
            CopyFileWithProgress(Source, Dest)
        else
            CopyFolderWithProgress(Source, Dest)
    }
    else if (ChosenOperation = "Move") {
        if (ItemExt != "") {
            FileMove, %Source%, %Dest%, 1
            FileGetSize, FileSize, %Source%
            ProcessedBytes += FileSize
        }
        else {
            FileMoveDir, %Source%, %Dest%, 1
            Loop, Files, %Dest%\*.*, R
                FileGetSize, FileSize, %A_LoopFileFullPath%
                ProcessedBytes += FileSize
        }
        Progress, %ProcessedBytes%
        Sleep, 10
    }
    else if (ChosenOperation = "Create Shortcut") {
        if (ItemExt != "")
            FileCreateShortcut, %Source%, %Dest%.lnk
        else
            FileCreateShortcut, %Source%, %Dest%.lnk
        ProcessedBytes += 100
        Progress, %ProcessedBytes%
        Sleep, 10
    }
}

CopyFileWithProgress(Source, Dest) {
    global CancelCopy, ProcessedBytes
    FileGetSize, FileSize, %Source%
    FileCopy, %Source%, %Dest%, 1
    if (CancelCopy) {
        FileDelete, %Dest%
    } else {
        ProcessedBytes += FileSize
        Progress, %ProcessedBytes%
        Sleep, 10
    }
}

CopyFolderWithProgress(Source, Dest) {
    global CancelCopy, ProcessedBytes
    FileCreateDir, %Dest%
    Loop, Files, %Source%\*.*, R
    {
        if (CancelCopy) {
            FileRemoveDir, %Dest%, 1
            return
        }
        RelPath := SubStr(A_LoopFileFullPath, StrLen(Source) + 2)
        TargetPath := Dest . "\" . RelPath
        SplitPath, TargetPath,, TargetDir
        IfNotExist, %TargetDir%
            FileCreateDir, %TargetDir%
        FileGetSize, FileSize, %A_LoopFileFullPath%
        FileCopy, %A_LoopFileFullPath%, %TargetPath%, 1
        ProcessedBytes += FileSize
        Progress, %ProcessedBytes%
        Sleep, 10
    }
}

ShowDuplicateDialog(ItemName, ItemType) {
    Gui, Duplicate:New, +AlwaysOnTop, %ItemType% Exists
    Gui, Add, Text,, The %ItemType% %ItemName% already exists
    Gui, Add, Button, x10 y50 w70 h30 gReplaceAction, Replace
    Gui, Add, Button, x85 y50 w70 h30 gRenameAction, Rename
    Gui, Add, Button, x160 y50 w70 h30 gCancelAction, Skip
    Gui, Add, Button, x235 y50 w70 h30 gCancelAllAction, Cancel All
    Gui, Add, Checkbox, x10 y90 w290 h20 vApplyToAll, Apply this choice to all duplicate items
    Gui, Show, w320 h120
    WinWaitClose, %ItemType% Exists
}

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\CopyMove0.ahk ===

ï»¿#SingleInstance Force

Clipboard := ""
Send {Ctrl down}
Sleep 100
Send {c down}
Sleep 100
Send {c up}
Send {Ctrl up}
ClipWait, 2
if (ErrorLevel) {
    return
}

; Global variables
global ApplyToAll := 0
global ChosenAction := ""
global ChosenOperation := ""
global CancelCopy := 0
global TotalBytes := 0
global ProcessedBytes := 0

; Split clipboard content into multiple items
ItemsToCopy := StrSplit(Clipboard, "`n", "`r")

; Calculate total size of files
Loop, % ItemsToCopy.Length()
{
    Item := Trim(ItemsToCopy[A_Index])
    IfExist, %Item%
    {
        SplitPath, Item,,, ItemExt
        if (ItemExt != "") {  ; File
            FileGetSize, FileSize, %Item%
            TotalBytes += FileSize
        }
        else {  ; Folder
            Loop, Files, %Item%\*.*, R
            {
                FileGetSize, FileSize, %A_LoopFileFullPath%
                TotalBytes += FileSize
            }
        }
    }
}

; Show initial operation selection dialog
Gui, Operation:New, +AlwaysOnTop, Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ©
Gui, Add, Text,, Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©:
Gui, Add, Button, x10 y50 w80 h30 gCopyOperation, Ù†Ø³Ø®
Gui, Add, Button, x100 y50 w80 h30 gMoveOperation, Ù†Ù‚Ù„
Gui, Add, Button, x190 y50 w80 h30 gShortcutOperation, Ø¥Ù†Ø´Ø§Ø¡ Ø§Ø®ØªØµØ§Ø±
Gui, Show, w300 h100
WinWaitClose, Ø§Ø®ØªØ± Ø§Ù„Ø¹Ù…Ù„ÙŠØ©

if (ChosenOperation = "")
    ExitApp

; Progress bar
Progress, B W100 H10 X0 Y0 Range0-%TotalBytes%
Progress, 0

; Process each item
Loop, % ItemsToCopy.Length()
{
    ItemToCopy := Trim(ItemsToCopy[A_Index])
    
    IfExist, %ItemToCopy%
    {
        SplitPath, ItemToCopy, ItemName,, ItemExt
        
        if (ItemExt != "") {  ; File
            TargetFile := "F:\Anime\" . ItemName
            IfNotExist, F:\Anime\
                FileCreateDir, F:\Anime\
            
            IfExist, %TargetFile%
            {
                if (ApplyToAll && ChosenAction != "") {
                    if (ChosenAction = "Replace")
                        Gosub, ReplaceAction
                    else if (ChosenAction = "Rename")
                        Gosub, RenameAction
                    else if (ChosenAction = "Cancel")
                        Gosub, SkipAction
                }
                else {
                    ShowDuplicateDialog(ItemName, "Ù…Ù„Ù")
                }
            }
            else
                ProcessItem(ItemToCopy, TargetFile)
        }
        else {  ; Folder
            TargetFolder := "F:\Anime\" . ItemName
            IfNotExist, F:\Anime\
                FileCreateDir, F:\Anime\
            
            IfExist, %TargetFolder%
            {
                if (ApplyToAll && ChosenAction != "") {
                    if (ChosenAction = "Replace")
                        Gosub, ReplaceAction
                    else if (ChosenAction = "Rename")
                        Gosub, RenameAction
                    else if (ChosenAction = "Cancel")
                        Gosub, SkipAction
                }
                else {
                    ShowDuplicateDialog(ItemName, "Ù…Ø¬Ù„Ø¯")
                }
            }
            else
                ProcessItem(ItemToCopy, TargetFolder)
        }
    }
    if (CancelCopy)
        break
}

DllCall("shell32\SHChangeNotify", "UInt", 0x08000000, "UInt", 0, "Ptr", 0, "Ptr", 0)
Progress, Off
ExitApp

CopyOperation:
ChosenOperation := "Copy"
Gui, Operation:Destroy
return

MoveOperation:
ChosenOperation := "Move"
Gui, Operation:Destroy
return

ShortcutOperation:
ChosenOperation := "Shortcut"
Gui, Operation:Destroy
return

SkipAction:
if (ItemExt != "") {
    FileGetSize, FileSize, %ItemToCopy%
    ProcessedBytes += FileSize
} else {
    Loop, Files, %ItemToCopy%\*.*, R
        FileGetSize, FileSize, %A_LoopFileFullPath%
        ProcessedBytes += FileSize
}
Progress, %ProcessedBytes%
Sleep, 10
return

CancelAction:
Gui, Duplicate:Submit
if (ApplyToAll)
    ChosenAction := "Cancel"
Gui, Duplicate:Destroy
return

CancelAllAction:
global CancelCopy := 1
Gui, Duplicate:Destroy
return

ReplaceAction:
Gui, Duplicate:Submit
if (ApplyToAll)
    ChosenAction := "Replace"
Gui, Duplicate:Destroy
if (ItemExt != "") {
    FileDelete, %TargetFile%
    ProcessItem(ItemToCopy, TargetFile)
} else {
    FileRemoveDir, %TargetFolder%, 1
    if (!ErrorLevel)
        ProcessItem(ItemToCopy, TargetFolder)
}
return

RenameAction:
Gui, Duplicate:Submit
if (ApplyToAll)
    ChosenAction := "Rename"
Gui, Duplicate:Destroy
Loop
{
    NewName := ItemName . " (" . A_Index . ")"
    if (ItemExt != "")
        NewTarget := "F:\Anime\" . NewName . "." . ItemExt
    else
        NewTarget := "F:\Anime\" . NewName
    
    IfNotExist, %NewTarget%
        break
}
ProcessItem(ItemToCopy, NewTarget)
return

ProcessItem(Source, Dest) {
    global ChosenOperation, ProcessedBytes
    if (ChosenOperation = "Copy") {
        if (ItemExt != "")
            CopyFileWithProgress(Source, Dest)
        else
            CopyFolderWithProgress(Source, Dest)
    }
    else if (ChosenOperation = "Move") {
        if (ItemExt != "")
            FileMove, %Source%, %Dest%, 1
        else
            FileMoveDir, %Source%, %Dest%, 1
        FileGetSize, FileSize, %Source%
        ProcessedBytes += FileSize
        Progress, %ProcessedBytes%
        Sleep, 10
    }
    else if (ChosenOperation = "Shortcut") {
        if (ItemExt != "")
            FileCreateShortcut, %Source%, %Dest%.lnk
        else
            FileCreateShortcut, %Source%, %Dest%.lnk
        ProcessedBytes += 100  ; Arbitrary size for shortcuts
        Progress, %ProcessedBytes%
        Sleep, 10
    }
}

CopyFileWithProgress(Source, Dest) {
    global CancelCopy, ProcessedBytes
    FileGetSize, FileSize, %Source%
    FileCopy, %Source%, %Dest%, 1
    if (CancelCopy) {
        FileDelete, %Dest%
    } else {
        ProcessedBytes += FileSize
        Progress, %ProcessedBytes%
        Sleep, 10
    }
}

CopyFolderWithProgress(Source, Dest) {
    global CancelCopy, ProcessedBytes
    FileCreateDir, %Dest%
    Loop, Files, %Source%\*.*, R
    {
        if (CancelCopy) {
            FileRemoveDir, %Dest%, 1
            return
        }
        RelPath := SubStr(A_LoopFileFullPath, StrLen(Source) + 2)
        TargetPath := Dest . "\" . RelPath
        SplitPath, TargetPath,, TargetDir
        IfNotExist, %TargetDir%
            FileCreateDir, %TargetDir%
        FileGetSize, FileSize, %A_LoopFileFullPath%
        FileCopy, %A_LoopFileFullPath%, %TargetPath%, 1
        ProcessedBytes += FileSize
        Progress, %ProcessedBytes%
        Sleep, 10
    }
}

ShowDuplicateDialog(ItemName, ItemType) {
    Gui, Duplicate:New, +AlwaysOnTop, %ItemType% Ù…ÙˆØ¬ÙˆØ¯
    Gui, Add, Text,, Ø§Ù„%ItemType% %ItemName% Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„ÙØ¹Ù„ ÙÙŠ F:\Anime
    Gui, Add, Button, x10 y50 w70 h30 gReplaceAction, Ø§Ø³ØªØ¨Ø¯Ø§Ù„
    Gui, Add, Button, x85 y50 w70 h30 gRenameAction, Ø¥Ø¹Ø§Ø¯Ø© ØªØ³Ù…ÙŠØ©
    Gui, Add, Button, x160 y50 w70 h30 gCancelAction, ØªØ®Ø·ÙŠ
    Gui, Add, Button, x235 y50 w70 h30 gCancelAllAction, Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ÙƒÙ„
    Gui, Add, Checkbox, x10 y90 w290 h20 vApplyToAll, ØªØ·Ø¨ÙŠÙ‚ Ù‡Ø°Ø§ Ø§Ù„Ø®ÙŠØ§Ø± Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ù…ØªÙƒØ±Ø±Ø©
    Gui, Show, w320 h120
    WinWaitClose, %ItemType% Ù…ÙˆØ¬ÙˆØ¯
}

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\DeleteLine.ahk ===

ï»¿Send, ^+{Left}{Del}
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\KillProses.ahk ===

ï»¿WinGet, ActivePID, PID, A
Process, Close, %ActivePID%
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\langChanger.ahk ===

ï»¿ClipSaved := ClipboardAll
Clipboard := ""
Send, ^c
Sleep, 100
SelectedText := Clipboard
if (SelectedText = "")
{
    Clipboard := ClipSaved
    return
}
ArToEn := { "Ø°": "``", "Ø¶": "q", "Øµ": "w", "Ø«": "e", "Ù‚": "r", "Ù": "t", "Øº": "y", "Ø¹": "u", "Ù‡": "i", "Ø®": "o"
, "Ø­": "p", "Ø¬": "[", "Ø¯": "]", "Ø´": "a", "Ø³": "s", "ÙŠ": "d", "Ø¨": "f", "Ù„": "g", "Ø§": "h", "Øª": "j"
, "Ù†": "k", "Ù…": "l", "Ùƒ": ";", "Ø·": "'", "Ø¦": "z", "Ø¡": "x", "Ø¤": "c", "Ø±": "v", "Ù„Ø§": "b"
, "Ù‰": "n", "Ø©": "m", "Ùˆ": ",", "Ø²": ".", "Ø¸": "/" }
EnToAr := { "``": "Ø°", "q": "Ø¶", "w": "Øµ", "e": "Ø«", "r": "Ù‚", "t": "Ù", "y": "Øº", "u": "Ø¹", "i": "Ù‡", "o": "Ø®"
, "p": "Ø­", "[": "Ø¬", "]": "Ø¯", "a": "Ø´", "s": "Ø³", "d": "ÙŠ", "f": "Ø¨", "g": "Ù„", "h": "Ø§", "j": "Øª"
, "k": "Ù†", "l": "Ù…", ";": "Ùƒ", "'": "Ø·", "z": "Ø¦", "x": "Ø¡", "c": "Ø¤", "v": "Ø±", "b": "Ù„Ø§"
, "n": "Ù‰", "m": "Ø©", ",": "Ùˆ", ".": "Ø²", "/": "Ø¸" }
ArabicCount := 0
EnglishCount := 0
Loop, Parse, SelectedText
{
    if RegExMatch(A_LoopField, "[Ø§Ø£Ø¥Ø¨ØªØ«Ø¬Ø­Ø®Ø¯Ø°Ø±Ø²Ø³Ø´ØµØ¶Ø·Ø¸Ø¹ØºÙÙ‚ÙƒÙ„Ù…Ù†Ù‡ÙˆÙŠØ©Ù‰Ø¦Ø¤Ù„Ø§]")
        ArabicCount++
    else if RegExMatch(A_LoopField, "[a-zA-Z]")
        EnglishCount++
}
IsArabic := (ArabicCount > EnglishCount)
NewText := ""
Loop, Parse, SelectedText
{
    Char := A_LoopField
    if (IsArabic)
    {
        NewChar := ArToEn[Char] ? ArToEn[Char] : Char
    }
    else
    {
        NewChar := EnToAr[Char] ? EnToAr[Char] : Char
    }
    NewText .= NewChar
}
Clipboard := NewText
Send, ^v
Sleep, 100
Clipboard := ClipSaved
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\Minimize.ahk ===

ï»¿WinMinimize, A
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\PlayPause.ahk ===

ï»¿Send, {Media_Play_Pause}
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\PowerOFF.ahk ===

ï»¿Sleep, 20
WinGet, id, list
Loop, %id%
{
    this_id := id%A_Index%
    WinGetClass, class, ahk_id %this_id%
    If (class = "WorkerW" or class = "Progman" or class = "Shell_TrayWnd")
        continue
    WinClose, ahk_id %this_id%
    Sleep, 50
}

MsgBox, 4, ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø¥ÙŠÙ‚Ø§Ù, Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ ØªØ±ÙŠØ¯ Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ´ØºÙŠÙ„ØŒ Ø³ÙŠØ¯ÙŠ ÙƒÙˆØ±ÙˆØ³ØŸ
IfMsgBox, No
    return
Shutdown, 5
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\qr.ahk ===

ï»¿#NoEnv
#SingleInstance Force
    pythonPath := "pythonw"  ; Ø£Ùˆ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„ÙƒØ§Ù…Ù„: "C:\Path\To\pythonw.exe"
    scriptPath := "c:\Users\KorosSama\Documents\GitHub\FlxAHK\Scripts\qr_display.py"
    command := pythonPath . " -u """ . scriptPath . """"
    Run, %command%  ; Ø¨Ø¯ÙˆÙ† HideØŒ Ù„Ø£Ù† pythonw Ù…Ø§ Ø¨ÙŠÙØªØ­ console Ø£ØµÙ„Ø§Ù‹
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\RunPath.ahk ===

ï»¿#SingleInstance Force  ; Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù†Ø³Ø®Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· ØªØ¹Ù…Ù„

If (InStr(Clipboard, "\") && FileExist(Clipboard)) ; Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³Ø§Ø±
    Run, %Clipboard%
Else
{
    ; Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø£Ø­Ù…Ø± Ø§Ù„ØµØºÙŠØ±
    BarHeight := 10  ; Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„Ø´Ø±ÙŠØ· ØµØºÙŠØ± (30 Ø¨ÙƒØ³Ù„)
    BarWidth := A_ScreenWidth
    FlashColor := "FF0000"  ; Ù„ÙˆÙ† Ø£Ø­Ù…Ø±
    StartY := A_ScreenHeight - BarHeight  ; Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙÙŠ Ø£Ø³ÙÙ„ Ø§Ù„Ø´Ø§Ø´Ø©
    StartX := (A_ScreenWidth - BarWidth) // 2  ; ØªÙˆØ³ÙŠØ· Ø§Ù„Ø´Ø±ÙŠØ· Ø£ÙÙ‚ÙŠÙ‹Ø§

    ; Ø¥Ù†Ø´Ø§Ø¡ GUI Ù„Ù„Ø´Ø±ÙŠØ·
    Gui, WarningBar:+LastFound +AlwaysOnTop -Caption +ToolWindow
    Gui, WarningBar:Color, %FlashColor%
    Gui, WarningBar:Show, x%StartX% y%StartY% w%BarWidth% h%BarHeight% NoActivate

    ; ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¸Ù‡ÙˆØ± Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ (Fade In)
    Loop, 15  ; Ø®Ø·ÙˆØ§Øª Ø£Ù‚Ù„ Ù„ØªØ³Ø±ÙŠØ¹ Ø§Ù„ØªØ£Ø«ÙŠØ±
    {
        Alpha := A_Index * 17  ; Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø´ÙØ§ÙÙŠØ© Ø¨Ø³Ø±Ø¹Ø© (Ù…Ù† 0 Ø¥Ù„Ù‰ 255 ØªÙ‚Ø±ÙŠØ¨Ù‹Ø§)
        WinSet, Transparent, %Alpha%, ahk_class AutoHotkeyGUI
        Sleep 2  ; Ø³Ø±Ø¹Ø© Ø§Ù„Ø¸Ù‡ÙˆØ± (75 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© ÙƒÙ„ Ø§Ù„ØªØ£Ø«ÙŠØ±)
    }

    Sleep 50  ; Ù…Ø¯Ø© Ø¨Ù‚Ø§Ø¡ Ø§Ù„Ø´Ø±ÙŠØ· (Ù†Øµ Ø«Ø§Ù†ÙŠØ©)

    ; ØªØ£Ø«ÙŠØ± Ø§Ù„Ø§Ø®ØªÙØ§Ø¡ Ø§Ù„ØªØ¯Ø±ÙŠØ¬ÙŠ (Fade Out)
    Loop, 15
    {
        Alpha := 255 - (A_Index * 17)  ; ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„Ø´ÙØ§ÙÙŠØ© Ø¨Ø³Ø±Ø¹Ø©
        WinSet, Transparent, %Alpha%, ahk_class AutoHotkeyGUI
        Sleep 2  ; Ø³Ø±Ø¹Ø© Ø§Ù„Ø§Ø®ØªÙØ§Ø¡
    }

    Gui, WarningBar:Destroy  ; Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø´Ø±ÙŠØ·
}
ExitApp

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\SetTimer.ahk ===

ï»¿InputBox, Minutes, ØªÙ†Ø¨ÙŠÙ‡, Ø¨Ø¹Ø¯ ÙƒÙ… Ø¯Ù‚ÙŠÙ‚Ø© ØªØ´ØªÙŠ Ø§Ù„ØªÙ†Ø¨ÙŠÙ‡ ÙŠØ´ØªØºÙ„ ÙŠØ§ Ø³ÙŠØ¯ ÙƒÙˆØ±ÙˆØ³ØŸ, , , , , , , 5
if (ErrorLevel = 0 && Minutes > 0)
{
    Sleep, % Minutes * 60000
    MsgBox, ÙŠØ§ ÙƒÙˆØ±ÙˆØ³ØŒ ÙƒÙ…Ù„ Ø§Ù„ÙˆÙ‚Øª!
}
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\sleepByRClick.ahk ===

#SingleInstance Force
#Persistent

SetTimer, CheckTime, 2000
return

CheckTime:
ExitApp
return

RButton::
DllCall("PowrProf\SetSuspendState", "int", 0, "int", 0, "int", 0)
Sleep, 1000
ExitApp
return

Left::
DllCall("PowrProf\SetSuspendState", "int", 1, "int", 0, "int", 0)
Sleep, 1000
ExitApp
return


==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\SuperScreenShot.ahk ===

ï»¿#SingleInstance Force
#Include %A_ScriptDir%\Gdip.ahk  ; Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ù†Ø³Ø¨ÙŠ Ù…Ù† Ù…Ø¬Ù„Ø¯ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù… (Scripts)
Input, Key, L1 T3  ; Ø§Ù†ØªØ¸Ø§Ø± Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù…Ù† NumPad Ù„Ù…Ø¯Ø© 3 Ø«ÙˆØ§Ù†ÙŠ
if (ErrorLevel = "Timeout")
    ExitApp

; ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù…Ù† Ù…Ù„Ù ini Ø¥Ø°Ø§ ÙƒØ§Ù† Ù…ÙˆØ¬ÙˆØ¯Ø§Ù‹
IniRead, MainFolder, %A_ScriptDir%\..\ScreenshotSettings.ini, Settings, MainFolder, %A_Desktop%
IniRead, Folder1, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder1, Folder1
IniRead, Folder2, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder2, Folder2
IniRead, Folder3, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder3, Folder3
IniRead, Folder4, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder4, Folder4
IniRead, Folder5, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder5, Folder5
IniRead, Folder6, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder6, Folder6
IniRead, Folder7, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder7, Folder7
IniRead, Folder8, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder8, Folder8
IniRead, Folder9, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder9, Folder9

if (Key = "0")
{
    Gui, 1:Destroy
    Gui, 1:+AlwaysOnTop
    Gui, 1:Add, Text,, Main Folder Path:
    Gui, 1:Add, Edit, vMainFolderPath w300, %MainFolder%
    Gui, 1:Add, Button, gBrowseMainFolder, Browse
    Gui, 1:Add, Text,, Folder Names:
    Gui, 1:Add, Text,, NumPad1:
    Gui, 1:Add, Edit, vFolder1 w200, %Folder1%
    Gui, 1:Add, Text,, NumPad2:
    Gui, 1:Add, Edit, vFolder2 w200, %Folder2%
    Gui, 1:Add, Text,, NumPad3:
    Gui, 1:Add, Edit, vFolder3 w200, %Folder3%
    Gui, 1:Add, Text,, NumPad4:
    Gui, 1:Add, Edit, vFolder4 w200, %Folder4%
    Gui, 1:Add, Text,, NumPad5:
    Gui, 1:Add, Edit, vFolder5 w200, %Folder5%
    Gui, 1:Add, Text,, NumPad6:
    Gui, 1:Add, Edit, vFolder6 w200, %Folder6%
    Gui, 1:Add, Text,, NumPad7:
    Gui, 1:Add, Edit, vFolder7 w200, %Folder7%
    Gui, 1:Add, Text,, NumPad8:
    Gui, 1:Add, Edit, vFolder8 w200, %Folder8%
    Gui, 1:Add, Text,, NumPad9:
    Gui, 1:Add, Edit, vFolder9 w200, %Folder9%
    Gui, 1:Add, Button, gSaveSettings Default, Save
    Gui, 1:Add, Button, gCancelSettings, Cancel
    Gui, 1:Show
    return
}

if (Key >= "1" && Key <= "9")
{
    FolderVar := "Folder" . Key
    TargetFolder := %FolderVar%
    FullPath := MainFolder . "\" . TargetFolder
    
    IfNotExist, %FullPath%
        FileCreateDir, %FullPath%
    
    FormatTime, TimeStamp,, yyyy-MM-dd_HH-mm-ss
    FileName := FullPath . "\Screenshot_" . TimeStamp . ".png"
    
    pToken := Gdip_Startup()
    if !pToken
    {
        MsgBox, GDI+ failed to start. Please ensure Gdip.ahk is in %A_ScriptDir%.
        ExitApp
    }
    
    pBitmap := Gdip_BitmapFromScreen("0|0|" . A_ScreenWidth . "|" . A_ScreenHeight)
    if !pBitmap
    {
        MsgBox, Failed to capture screen.
        Gdip_Shutdown(pToken)
        ExitApp
    }
    
    Gdip_SaveBitmapToFile(pBitmap, FileName)
    Gdip_DisposeImage(pBitmap)
    Gdip_Shutdown(pToken)

    ; Ø¥Ø¹Ø¯Ø§Ø¯ ØªØ£Ø«ÙŠØ± Ø§Ù„ÙˆÙ…ÙŠØ¶ Ø¹Ù„Ù‰ Ø§Ù„Ø­ÙˆØ§Ù
    BorderWidth := 7  ; Ø¹Ø±Ø¶ Ø§Ù„Ø­Ø§ÙØ© (ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„Ù‡ Ø­Ø³Ø¨ Ø±ØºØ¨ØªÙƒ)
    FlashColor := "FFFFFF"  ; Ù„ÙˆÙ† Ø§Ù„ÙˆÙ…ÙŠØ¶ (Ø£Ø¨ÙŠØ¶ØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªØºÙŠÙŠØ±Ù‡ Ù…Ø«Ù„ "FFFF00" Ù„Ù„Ø£ØµÙØ±)

    ; Ø¥Ù†Ø´Ø§Ø¡ GUI Ù„Ù„Ø­Ø§ÙØ© Ø§Ù„Ø¹Ù„ÙˆÙŠØ©
    Gui, BorderTop:+LastFound +AlwaysOnTop -Caption +ToolWindow
    Gui, BorderTop:Color, %FlashColor%
    Gui, BorderTop:Show, x0 y0 w%A_ScreenWidth% h%BorderWidth% NoActivate

    ; Ø¥Ù†Ø´Ø§Ø¡ GUI Ù„Ù„Ø­Ø§ÙØ© Ø§Ù„Ø³ÙÙ„ÙŠØ©
    Gui, BorderBottom:+LastFound +AlwaysOnTop -Caption +ToolWindow
    Gui, BorderBottom:Color, %FlashColor%
    BottomY := A_ScreenHeight - BorderWidth
    Gui, BorderBottom:Show, x0 y%BottomY% w%A_ScreenWidth% h%BorderWidth% NoActivate

    ; Ø¥Ù†Ø´Ø§Ø¡ GUI Ù„Ù„Ø­Ø§ÙØ© Ø§Ù„ÙŠØ³Ø±Ù‰
    Gui, BorderLeft:+LastFound +AlwaysOnTop -Caption +ToolWindow
    Gui, BorderLeft:Color, %FlashColor%
    Gui, BorderLeft:Show, x0 y0 w%BorderWidth% h%A_ScreenHeight% NoActivate

    ; Ø¥Ù†Ø´Ø§Ø¡ GUI Ù„Ù„Ø­Ø§ÙØ© Ø§Ù„ÙŠÙ…Ù†Ù‰
    Gui, BorderRight:+LastFound +AlwaysOnTop -Caption +ToolWindow
    Gui, BorderRight:Color, %FlashColor%
    RightX := A_ScreenWidth - BorderWidth
    Gui, BorderRight:Show, x%RightX% y0 w%BorderWidth% h%A_ScreenHeight% NoActivate

    ; Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„ÙØªØ±Ø© Ù‚ØµÙŠØ±Ø© (Ù…Ø¯Ø© Ø§Ù„ÙˆÙ…ÙŠØ¶)
    Sleep, 100  ; 100 Ù…Ù„Ù„ÙŠ Ø«Ø§Ù†ÙŠØ© (ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø¯Ø©)

    ; Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­ÙˆØ§Ù
    Gui, BorderTop:Destroy
    Gui, BorderBottom:Destroy
    Gui, BorderLeft:Destroy
    Gui, BorderRight:Destroy
}

Exitapp

BrowseMainFolder:
Gui, 1:Submit, NoHide
FileSelectFolder, SelectedFolder, , 3
if SelectedFolder !=
    GuiControl, 1:, MainFolderPath, %SelectedFolder%
Exitapp

SaveSettings:
Gui, 1:Submit
if (MainFolderPath = "")
    MainFolderPath := A_Desktop
if (Folder1 = "" or Folder1 = "Folder1")
    Folder1 := "Folder1"
if (Folder2 = "" or Folder2 = "Folder2")
    Folder2 := "Folder2"
if (Folder3 = "" or Folder3 = "Folder3")
    Folder3 := "Folder3"
if (Folder4 = "" or Folder4 = "Folder4")
    Folder4 := "Folder4"
if (Folder5 = "" or Folder5 = "Folder5")
    Folder5 := "Folder5"
if (Folder6 = "" or Folder6 = "Folder6")
    Folder6 := "Folder6"
if (Folder7 = "" or Folder7 = "Folder7")
    Folder7 := "Folder7"
if (Folder8 = "" or Folder8 = "Folder8")
    Folder8 := "Folder8"
if (Folder9 = "" or Folder9 = "Folder9")
    Folder9 := "Folder9"

IniRead, OldMainFolder, %A_ScriptDir%\..\ScreenshotSettings.ini, Settings, MainFolder, %A_Desktop%
IniRead, OldFolder1, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder1, Folder1
IniRead, OldFolder2, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder2, Folder2
IniRead, OldFolder3, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder3, Folder3
IniRead, OldFolder4, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder4, Folder4
IniRead, OldFolder5, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder5, Folder5
IniRead, OldFolder6, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder6, Folder6
IniRead, OldFolder7, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder7, Folder7
IniRead, OldFolder8, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder8, Folder8
IniRead, OldFolder9, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder9, Folder9

if (OldMainFolder != MainFolderPath && InStr(FileExist(OldMainFolder), "D"))
{
    FileMoveDir, %OldMainFolder%, %MainFolderPath%, R
    if (ErrorLevel)
        MsgBox, Failed to rename main folder from %OldMainFolder% to %MainFolderPath%. ErrorLevel: %ErrorLevel%
}

OldFolders := [OldFolder1, OldFolder2, OldFolder3, OldFolder4, OldFolder5, OldFolder6, OldFolder7, OldFolder8, OldFolder9]
NewFolders := [Folder1, Folder2, Folder3, Folder4, Folder5, Folder6, Folder7, Folder8, Folder9]

Loop, 9
{
    OldFolder := OldFolders[A_Index]
    NewFolder := NewFolders[A_Index]
    OldPath := OldMainFolder . "\" . OldFolder
    NewPath := MainFolderPath . "\" . NewFolder

    if (OldFolder != NewFolder && InStr(FileExist(OldPath), "D"))
    {
        FileMoveDir, %OldPath%, %NewPath%, R
        if (ErrorLevel)
            MsgBox, Failed to rename folder from %OldPath% to %NewPath%. ErrorLevel: %ErrorLevel%
    }
}

IniWrite, %MainFolderPath%, %A_ScriptDir%\..\ScreenshotSettings.ini, Settings, MainFolder
IniWrite, %Folder1%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder1
IniWrite, %Folder2%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder2
IniWrite, %Folder3%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder3
IniWrite, %Folder4%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder4
IniWrite, %Folder5%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder5
IniWrite, %Folder6%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder6
IniWrite, %Folder7%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder7
IniWrite, %Folder8%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder8
IniWrite, %Folder9%, %A_ScriptDir%\..\ScreenshotSettings.ini, Folders, Folder9

Gui, 1:Destroy
Exitapp

CancelSettings:
Gui, 1:Destroy
Exitapp

GuiClose:
Gui, 1:Destroy
Exitapp

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\Transi.ahk ===

ï»¿WinSet, Transparent, 255, A
WinSet, Transparent, OFF, A
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\TransO.ahk ===

ï»¿WinGet, TransLevel, Transparent, A
if (TransLevel = "") {
    TransLevel := 255
}
if (TransLevel <= 55) {
    TransLevel := 255
} else {
    TransLevel -= 50
}
WinSet, Transparent, %TransLevel%, A
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\TransP.ahk ===

ï»¿WinSet, Transparent, 0, A
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\VlcPlayList.ahk ===

#SingleInstance Force
SetWorkingDir %A_ScriptDir%

; Ù…Ø³Ø§Ø± VLC
VLCPath := "C:\Program Files (x86)\VideoLAN\VLC/vlc.exe"

; Ø§Ù„ØªØ­Ù‚Ù‚ Ø£ÙˆÙ„Ø§Ù‹ Ù…Ù† Ø§Ù„Ù…Ø¬Ù„Ø¯ Ø§Ù„Ù…Ø­Ø¯Ø¯ Ø¹Ø¨Ø± Ø§Ù„Ø­Ø§ÙØ¸Ø©
FolderPath := GetFolderFromClipboard()
if (FolderPath = "" || !FileExist(FolderPath)) {
    ; Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† Ù‡Ù†Ø§Ùƒ Ù…Ø¬Ù„Ø¯ Ù…Ø­Ø¯Ø¯ Ø£Ùˆ Ø§Ù„Ù…Ø³Ø§Ø± ØºÙŠØ± ØµØ§Ù„Ø­ØŒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù…Ø³ØªÙƒØ´Ù
    FolderPath := GetActiveExplorerPath()
    if (FolderPath = "") {
        MsgBox, Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ù…Ø¬Ù„Ø¯ Ù…ÙØªÙˆØ­ Ø£Ùˆ Ù…Ø­Ø¯Ø¯!
        ExitApp
    }
}

; ØªØ´ØºÙŠÙ„ VLC Ù…Ø¨Ø§Ø´Ø±Ø© Ø¨Ø¯ÙˆÙ† ÙˆØ§Ø¬Ù‡Ø©
Run, "%VLCPath%" "--playlist-autostart" "--loop" "%FolderPath%"
ExitApp

; Ø¯Ø§Ù„Ø© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø³Ø§Ø± Ù…Ù† Ø§Ù„Ø­Ø§ÙØ¸Ø©
GetFolderFromClipboard() {
    if (WinActive("ahk_class CabinetWClass") || WinActive("ahk_class ExplorerWClass")) {
        ClipboardOld := ClipboardAll  ; Ø­ÙØ¸ Ø§Ù„Ø­Ø§ÙØ¸Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©
        Clipboard := ""  ; ØªÙØ±ÙŠØº Ø§Ù„Ø­Ø§ÙØ¸Ø©
        Send {Ctrl down}
        Sleep 50
        Send {c down}
        Sleep 50
        Send {c up}
        Send {Ctrl up}
        ClipWait, 1  ; Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ù„Ù…Ø¯Ø© Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©
        if (!ErrorLevel && FileExist(Clipboard)) {
            FolderPath := Trim(Clipboard, "`n`r")
            Clipboard := ClipboardOld  ; Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø§ÙØ¸Ø©
            return FolderPath
        }
        Clipboard := ClipboardOld  ; Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø§Ù„Ø­Ø§ÙØ¸Ø© Ø¥Ø°Ø§ ÙØ´Ù„
    }
    return ""  ; Ø¥Ø±Ø¬Ø§Ø¹ ÙØ§Ø±Øº Ø¥Ø°Ø§ Ù„Ù… ÙŠÙ†Ø¬Ø­
}

; Ø¯Ø§Ù„Ø© Ù„Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ù…Ø³Ø§Ø± Ù…Ù† Ù…Ø³ØªÙƒØ´Ù Ø§Ù„Ù…Ù„ÙØ§Øª
GetActiveExplorerPath() {
    WinGet, activeWin, ID, A
    for window in ComObjCreate("Shell.Application").Windows {
        if (window.HWND = activeWin) {
            return window.Document.Folder.Self.Path
        }
    }
    return ""
}

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\VolumeDown.ahk ===

ï»¿SoundSet, -5
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\VolumeUp.ahk ===

ï»¿SoundSet, +5
return

==================================================


=== C:/Users/KorosSama/Documents/GitHub/FlxAHK\Scripts\Zshort.ahk ===

ï»¿#SingleInstance Force  ; Ù„Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† Ù†Ø³Ø®Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø· ØªØ¹Ù…Ù„
WinGetClass, ActiveClass, A
if (ActiveClass = "Photoshop")
{
    Send, ^+!]
    ExitApp  ; Ø¥Ù†Ù‡Ø§Ø¡ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ø¨Ø¹Ø¯ Ø§Ù„ØªÙ†ÙÙŠØ°
}
else
    Input, Key, L1 T3
if (ErrorLevel = "Timeout")
    ExitApp  ; Ø¥Ù†Ù‡Ø§Ø¡ Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø£ÙˆÙ„
if (StrLen(key) = 1) {
    if (key = "z" || key = "Z") {
        if (ActiveClass = "Chrome_WidgetWin_1")
        {
            Input, key, L1 T3
            if (ErrorLevel = "Timeout")
                ExitApp  ; Ø¥Ù†Ù‡Ø§Ø¡ Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Ù‰ ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø§Ù„Ø«Ø§Ù†ÙŠ
            if (StrLen(key) = 1)
            {
                if (key = "z" || key = "Z")
                {
                    Send, ^+!\
                    Sleep, 100
                    Send, ^+!r
                    ExitApp
                }
                else if (key = "]")
                {
                    Send, ^+!]
                    Sleep, 10
                    Send, ]
                    Sleep, 10
                    Send, ^+!]
                    Sleep, 10
                    Send, i
                    Input, AnyKey, L1 T10
                    Send, ^+!r
                    ExitApp
                }
                else if (key = "[")
                {
                    Send, ^+!]
                    Sleep, 10
                    Send, p
                    Sleep, 10
                    Send, ^+!]
                    Sleep, 10
                    Send, i
                    Input, AnyKey, L1 T10
                    Send, ^+!r
                    ExitApp
                }
                else if (key = "p" || key = "P")
                {
                    Send, ^+!]
                    Sleep, 10
                    Send, [
                    Sleep, 10
                    Send, ^+!]
                    Sleep, 10
                    Send, ^p
                    Input, AnyKey, L1 T10
                    Send, ^+!r
                    ExitApp
                }
                ExitApp
            }
        }
        else {
            Send, ^+!%key%
            ExitApp
        }
    }
    else
    {
        Send, ^+!%key%
        ExitApp
    }
}
else
{
    Input, key, L1
    ExitApp
}
ExitApp  ; Ø¥Ù†Ù‡Ø§Ø¡ Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø¥Ø¯Ø®Ø§Ù„ Ø´ÙŠØ¡

==================================================

